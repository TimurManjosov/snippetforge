6212f378fd585537e4b84a297b0058e2
"use strict";
// test/mocks/auth.mock.ts
Object.defineProperty(exports, "__esModule", { value: true });
exports.createMockReflector = exports.createMockJwtService = exports.createMockAuthService = void 0;
exports.createMockTokenResponse = createMockTokenResponse;
exports.createMockAuthResponse = createMockAuthResponse;
exports.createMockJwtPayload = createMockJwtPayload;
const users_mock_1 = require("./users.mock");
/**
 * Auth Mocks
 *
 * Mock-Implementierungen fÃ¼r AuthService und JwtService.
 */
// ========================================
// SERVICE MOCKS
// ========================================
const createMockAuthService = () => ({
    register: jest.fn(),
    login: jest.fn(),
    validateUserById: jest.fn(),
    getCurrentUser: jest.fn(),
});
exports.createMockAuthService = createMockAuthService;
const createMockJwtService = () => ({
    sign: jest.fn().mockReturnValue('mock-jwt-token'),
    signAsync: jest.fn().mockResolvedValue('mock-jwt-token'),
    verify: jest
        .fn()
        .mockReturnValue({ sub: 'user-id', email: 'test@test.com', role: 'USER' }),
    verifyAsync: jest.fn().mockResolvedValue({
        sub: 'user-id',
        email: 'test@test.com',
        role: 'USER',
    }),
    decode: jest
        .fn()
        .mockReturnValue({ sub: 'user-id', email: 'test@test.com', role: 'USER' }),
});
exports.createMockJwtService = createMockJwtService;
// ========================================
// REFLECTOR MOCK
// ========================================
const createMockReflector = () => ({
    get: jest.fn(),
    getAll: jest.fn(),
    getAllAndMerge: jest.fn(),
    getAllAndOverride: jest.fn(),
});
exports.createMockReflector = createMockReflector;
// ========================================
// TEST DATA
// ========================================
/**
 * Erstellt eine Mock TokenResponse
 */
function createMockTokenResponse() {
    return {
        accessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0LXVzZXItaWQiLCJlbWFpbCI6InRlc3RAdGVzdC5jb20iLCJyb2xlIjoiVVNFUiJ9.mock-signature',
        tokenType: 'Bearer',
        expiresIn: 900,
    };
}
/**
 * Erstellt eine Mock AuthResponse
 */
function createMockAuthResponse(userOverrides = {}) {
    return {
        user: (0, users_mock_1.createMockSafeUser)(userOverrides),
        tokens: createMockTokenResponse(),
    };
}
/**
 * Erstellt einen Mock JWT Payload
 */
function createMockJwtPayload(overrides = {}) {
    return {
        sub: 'test-user-id-123',
        email: 'test@example.com',
        role: 'USER',
        iat: Math.floor(Date.now() / 1000),
        exp: Math.floor(Date.now() / 1000) + 900,
        ...overrides,
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aW11clxcUHJvZ3JhbW1pbmdcXFByb2plY3RzXFxzbmlwcGV0Zm9yZ2VcXGFwcHNcXGFwaVxcdGVzdFxcbW9ja3NcXGF1dGgubW9jay50cyIsIm1hcHBpbmdzIjoiO0FBQUEsMEJBQTBCOzs7QUErRDFCLDBEQU9DO0FBS0Qsd0RBS0M7QUFLRCxvREFTQztBQTFGRCw2Q0FBa0Q7QUFFbEQ7Ozs7R0FJRztBQUVILDJDQUEyQztBQUMzQyxnQkFBZ0I7QUFDaEIsMkNBQTJDO0FBRXBDLE1BQU0scUJBQXFCLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMxQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNuQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNoQixnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzNCLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQzFCLENBQUMsQ0FBQztBQUxVLFFBQUEscUJBQXFCLHlCQUsvQjtBQUlJLE1BQU0sb0JBQW9CLEdBQUcsR0FBd0IsRUFBRSxDQUFDLENBQUM7SUFDOUQsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLENBQUM7SUFDakQsU0FBUyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxnQkFBZ0IsQ0FBQztJQUN4RCxNQUFNLEVBQUUsSUFBSTtTQUNULEVBQUUsRUFBRTtTQUNKLGVBQWUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUM7SUFDNUUsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztRQUN2QyxHQUFHLEVBQUUsU0FBUztRQUNkLEtBQUssRUFBRSxlQUFlO1FBQ3RCLElBQUksRUFBRSxNQUFNO0tBQ2IsQ0FBQztJQUNGLE1BQU0sRUFBRSxJQUFJO1NBQ1QsRUFBRSxFQUFFO1NBQ0osZUFBZSxDQUFDLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsZUFBZSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQztDQUM3RSxDQUFDLENBQUM7QUFkVSxRQUFBLG9CQUFvQix3QkFjOUI7QUFJSCwyQ0FBMkM7QUFDM0MsaUJBQWlCO0FBQ2pCLDJDQUEyQztBQUVwQyxNQUFNLG1CQUFtQixHQUFHLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDeEMsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZCxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNqQixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUN6QixpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQzdCLENBQUMsQ0FBQztBQUxVLFFBQUEsbUJBQW1CLHVCQUs3QjtBQUlILDJDQUEyQztBQUMzQyxZQUFZO0FBQ1osMkNBQTJDO0FBRTNDOztHQUVHO0FBQ0gsU0FBZ0IsdUJBQXVCO0lBQ3JDLE9BQU87UUFDTCxXQUFXLEVBQ1Qsc0lBQXNJO1FBQ3hJLFNBQVMsRUFBRSxRQUFRO1FBQ25CLFNBQVMsRUFBRSxHQUFHO0tBQ2YsQ0FBQztBQUNKLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLHNCQUFzQixDQUFDLGFBQWEsR0FBRyxFQUFFO0lBQ3ZELE9BQU87UUFDTCxJQUFJLEVBQUUsSUFBQSwrQkFBa0IsRUFBQyxhQUFhLENBQUM7UUFDdkMsTUFBTSxFQUFFLHVCQUF1QixFQUFFO0tBQ2xDLENBQUM7QUFDSixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixvQkFBb0IsQ0FBQyxTQUFTLEdBQUcsRUFBRTtJQUNqRCxPQUFPO1FBQ0wsR0FBRyxFQUFFLGtCQUFrQjtRQUN2QixLQUFLLEVBQUUsa0JBQWtCO1FBQ3pCLElBQUksRUFBRSxNQUFNO1FBQ1osR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQztRQUNsQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLEdBQUcsR0FBRztRQUN4QyxHQUFHLFNBQVM7S0FDYixDQUFDO0FBQ0osQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXHRpbXVyXFxQcm9ncmFtbWluZ1xcUHJvamVjdHNcXHNuaXBwZXRmb3JnZVxcYXBwc1xcYXBpXFx0ZXN0XFxtb2Nrc1xcYXV0aC5tb2NrLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHRlc3QvbW9ja3MvYXV0aC5tb2NrLnRzXHJcblxyXG5pbXBvcnQgeyBKd3RTZXJ2aWNlIH0gZnJvbSAnQG5lc3Rqcy9qd3QnO1xyXG5pbXBvcnQgeyB0eXBlIEF1dGhSZXNwb25zZSwgdHlwZSBUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vc3JjL21vZHVsZXMvYXV0aCc7XHJcbmltcG9ydCB7IGNyZWF0ZU1vY2tTYWZlVXNlciB9IGZyb20gJy4vdXNlcnMubW9jayc7XHJcblxyXG4vKipcclxuICogQXV0aCBNb2Nrc1xyXG4gKlxyXG4gKiBNb2NrLUltcGxlbWVudGllcnVuZ2VuIGbDvHIgQXV0aFNlcnZpY2UgdW5kIEp3dFNlcnZpY2UuXHJcbiAqL1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBTRVJWSUNFIE1PQ0tTXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVNb2NrQXV0aFNlcnZpY2UgPSAoKSA9PiAoe1xyXG4gIHJlZ2lzdGVyOiBqZXN0LmZuKCksXHJcbiAgbG9naW46IGplc3QuZm4oKSxcclxuICB2YWxpZGF0ZVVzZXJCeUlkOiBqZXN0LmZuKCksXHJcbiAgZ2V0Q3VycmVudFVzZXI6IGplc3QuZm4oKSxcclxufSk7XHJcblxyXG5leHBvcnQgdHlwZSBNb2NrQXV0aFNlcnZpY2UgPSBSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVNb2NrQXV0aFNlcnZpY2U+O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZU1vY2tKd3RTZXJ2aWNlID0gKCk6IFBhcnRpYWw8Snd0U2VydmljZT4gPT4gKHtcclxuICBzaWduOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKCdtb2NrLWp3dC10b2tlbicpLFxyXG4gIHNpZ25Bc3luYzogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdtb2NrLWp3dC10b2tlbicpLFxyXG4gIHZlcmlmeTogamVzdFxyXG4gICAgLmZuKClcclxuICAgIC5tb2NrUmV0dXJuVmFsdWUoeyBzdWI6ICd1c2VyLWlkJywgZW1haWw6ICd0ZXN0QHRlc3QuY29tJywgcm9sZTogJ1VTRVInIH0pLFxyXG4gIHZlcmlmeUFzeW5jOiBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgc3ViOiAndXNlci1pZCcsXHJcbiAgICBlbWFpbDogJ3Rlc3RAdGVzdC5jb20nLFxyXG4gICAgcm9sZTogJ1VTRVInLFxyXG4gIH0pLFxyXG4gIGRlY29kZTogamVzdFxyXG4gICAgLmZuKClcclxuICAgIC5tb2NrUmV0dXJuVmFsdWUoeyBzdWI6ICd1c2VyLWlkJywgZW1haWw6ICd0ZXN0QHRlc3QuY29tJywgcm9sZTogJ1VTRVInIH0pLFxyXG59KTtcclxuXHJcbmV4cG9ydCB0eXBlIE1vY2tKd3RTZXJ2aWNlID0gUmV0dXJuVHlwZTx0eXBlb2YgY3JlYXRlTW9ja0p3dFNlcnZpY2U+O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBSRUZMRUNUT1IgTU9DS1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja1JlZmxlY3RvciA9ICgpID0+ICh7XHJcbiAgZ2V0OiBqZXN0LmZuKCksXHJcbiAgZ2V0QWxsOiBqZXN0LmZuKCksXHJcbiAgZ2V0QWxsQW5kTWVyZ2U6IGplc3QuZm4oKSxcclxuICBnZXRBbGxBbmRPdmVycmlkZTogamVzdC5mbigpLFxyXG59KTtcclxuXHJcbmV4cG9ydCB0eXBlIE1vY2tSZWZsZWN0b3IgPSBSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVNb2NrUmVmbGVjdG9yPjtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gVEVTVCBEQVRBXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8qKlxyXG4gKiBFcnN0ZWxsdCBlaW5lIE1vY2sgVG9rZW5SZXNwb25zZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU1vY2tUb2tlblJlc3BvbnNlKCk6IFRva2VuUmVzcG9uc2Uge1xyXG4gIHJldHVybiB7XHJcbiAgICBhY2Nlc3NUb2tlbjpcclxuICAgICAgJ2V5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUp6ZFdJaU9pSjBaWE4wTFhWelpYSXRhV1FpTENKbGJXRnBiQ0k2SW5SbGMzUkFkR1Z6ZEM1amIyMGlMQ0p5YjJ4bElqb2lWVk5GVWlKOS5tb2NrLXNpZ25hdHVyZScsXHJcbiAgICB0b2tlblR5cGU6ICdCZWFyZXInLFxyXG4gICAgZXhwaXJlc0luOiA5MDAsXHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVyc3RlbGx0IGVpbmUgTW9jayBBdXRoUmVzcG9uc2VcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNb2NrQXV0aFJlc3BvbnNlKHVzZXJPdmVycmlkZXMgPSB7fSk6IEF1dGhSZXNwb25zZSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHVzZXI6IGNyZWF0ZU1vY2tTYWZlVXNlcih1c2VyT3ZlcnJpZGVzKSxcclxuICAgIHRva2VuczogY3JlYXRlTW9ja1Rva2VuUmVzcG9uc2UoKSxcclxuICB9O1xyXG59XHJcblxyXG4vKipcclxuICogRXJzdGVsbHQgZWluZW4gTW9jayBKV1QgUGF5bG9hZFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU1vY2tKd3RQYXlsb2FkKG92ZXJyaWRlcyA9IHt9KSB7XHJcbiAgcmV0dXJuIHtcclxuICAgIHN1YjogJ3Rlc3QtdXNlci1pZC0xMjMnLFxyXG4gICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcclxuICAgIHJvbGU6ICdVU0VSJyxcclxuICAgIGlhdDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCksXHJcbiAgICBleHA6IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgOTAwLFxyXG4gICAgLi4ub3ZlcnJpZGVzLFxyXG4gIH07XHJcbn1cclxuIl0sInZlcnNpb24iOjN9