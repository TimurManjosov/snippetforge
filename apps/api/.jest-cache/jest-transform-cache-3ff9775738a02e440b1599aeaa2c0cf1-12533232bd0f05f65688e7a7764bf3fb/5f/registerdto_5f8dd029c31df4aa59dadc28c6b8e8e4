438e2367ddfb8c59dfd86b7af034bc3a
"use strict";
// src/modules/auth/dto/register.dto.ts
Object.defineProperty(exports, "__esModule", { value: true });
exports.RegisterSchema = void 0;
exports.validateRegisterDto = validateRegisterDto;
exports.safeValidateRegisterDto = safeValidateRegisterDto;
const zod_1 = require("zod");
/**
 * Register DTO - Validierung für User-Registrierung
 *
 * WARUM Zod statt class-validator?
 * 1. Type Inference:  Schema generiert automatisch TypeScript Types
 * 2. Runtime + Compile-Time Safety:  Ein Schema für beides
 * 3. Bessere Fehlermeldungen:  Detaillierte Validation Errors
 * 4. Shared:  Kann in Frontend UND Backend verwendet werden
 * 5. Functional:  Kein Decorator-Magic, pure Functions
 *
 * VALIDATION RULES:
 * - email:  Valides Email-Format, lowercase
 * - username: 3-30 Zeichen, alphanumerisch + underscore
 * - password:  Min 8 Zeichen, Komplexitätsregeln
 */
// Username Pattern:  Alphanumerisch + Underscore, keine Leerzeichen
const USERNAME_REGEX = /^[a-zA-Z0-9_]+$/;
// Password muss enthalten:  Großbuchstabe, Kleinbuchstabe, Zahl
const PASSWORD_REGEX = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/;
exports.RegisterSchema = zod_1.z.object({
    email: zod_1.z
        .string()
        .email('Invalid email format')
        .max(255, 'Email must be at most 255 characters')
        .transform((val) => val.toLowerCase().trim()), // Normalisierung
    username: zod_1.z
        .string()
        .min(3, 'Username must be at least 3 characters')
        .max(30, 'Username must be at most 30 characters')
        .regex(USERNAME_REGEX, 'Username can only contain letters, numbers, and underscores')
        .transform((val) => val.trim()),
    password: zod_1.z
        .string()
        .min(8, 'Password must be at least 8 characters')
        .max(100, 'Password must be at most 100 characters')
        .regex(PASSWORD_REGEX, 'Password must contain at least one uppercase letter, one lowercase letter, and one number'),
});
/**
 * Validation Function
 * Kann auch außerhalb von NestJS verwendet werden
 */
function validateRegisterDto(data) {
    return exports.RegisterSchema.parse(data);
}
/**
 * Safe Validation (wirft keinen Error)
 * Gibt Result-Object zurück
 */
function safeValidateRegisterDto(data) {
    return exports.RegisterSchema.safeParse(data);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aW11clxcUHJvZ3JhbW1pbmdcXFByb2plY3RzXFxzbmlwcGV0Zm9yZ2VcXGFwcHNcXGFwaVxcc3JjXFxtb2R1bGVzXFxhdXRoXFxkdG9cXHJlZ2lzdGVyLmR0by50cyIsIm1hcHBpbmdzIjoiO0FBQUEsdUNBQXVDOzs7QUF1RXZDLGtEQUVDO0FBTUQsMERBRUM7QUEvRUQsNkJBQXdCO0FBRXhCOzs7Ozs7Ozs7Ozs7OztHQWNHO0FBRUgsb0VBQW9FO0FBQ3BFLE1BQU0sY0FBYyxHQUFHLGlCQUFpQixDQUFDO0FBRXpDLGdFQUFnRTtBQUNoRSxNQUFNLGNBQWMsR0FBRyxpQ0FBaUMsQ0FBQztBQUU1QyxRQUFBLGNBQWMsR0FBRyxPQUFDLENBQUMsTUFBTSxDQUFDO0lBQ3JDLEtBQUssRUFBRSxPQUFDO1NBQ0wsTUFBTSxFQUFFO1NBQ1IsS0FBSyxDQUFDLHNCQUFzQixDQUFDO1NBQzdCLEdBQUcsQ0FBQyxHQUFHLEVBQUUsc0NBQXNDLENBQUM7U0FDaEQsU0FBUyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxpQkFBaUI7SUFFbEUsUUFBUSxFQUFFLE9BQUM7U0FDUixNQUFNLEVBQUU7U0FDUixHQUFHLENBQUMsQ0FBQyxFQUFFLHdDQUF3QyxDQUFDO1NBQ2hELEdBQUcsQ0FBQyxFQUFFLEVBQUUsd0NBQXdDLENBQUM7U0FDakQsS0FBSyxDQUNKLGNBQWMsRUFDZCw2REFBNkQsQ0FDOUQ7U0FDQSxTQUFTLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUVqQyxRQUFRLEVBQUUsT0FBQztTQUNSLE1BQU0sRUFBRTtTQUNSLEdBQUcsQ0FBQyxDQUFDLEVBQUUsd0NBQXdDLENBQUM7U0FDaEQsR0FBRyxDQUFDLEdBQUcsRUFBRSx5Q0FBeUMsQ0FBQztTQUNuRCxLQUFLLENBQ0osY0FBYyxFQUNkLDJGQUEyRixDQUM1RjtDQUNKLENBQUMsQ0FBQztBQWdCSDs7O0dBR0c7QUFDSCxTQUFnQixtQkFBbUIsQ0FBQyxJQUFhO0lBQy9DLE9BQU8sc0JBQWMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDcEMsQ0FBQztBQUVEOzs7R0FHRztBQUNILFNBQWdCLHVCQUF1QixDQUFDLElBQWE7SUFDbkQsT0FBTyxzQkFBYyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN4QyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGltdXJcXFByb2dyYW1taW5nXFxQcm9qZWN0c1xcc25pcHBldGZvcmdlXFxhcHBzXFxhcGlcXHNyY1xcbW9kdWxlc1xcYXV0aFxcZHRvXFxyZWdpc3Rlci5kdG8udHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL21vZHVsZXMvYXV0aC9kdG8vcmVnaXN0ZXIuZHRvLnRzXHJcblxyXG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcclxuXHJcbi8qKlxyXG4gKiBSZWdpc3RlciBEVE8gLSBWYWxpZGllcnVuZyBmw7xyIFVzZXItUmVnaXN0cmllcnVuZ1xyXG4gKlxyXG4gKiBXQVJVTSBab2Qgc3RhdHQgY2xhc3MtdmFsaWRhdG9yP1xyXG4gKiAxLiBUeXBlIEluZmVyZW5jZTogIFNjaGVtYSBnZW5lcmllcnQgYXV0b21hdGlzY2ggVHlwZVNjcmlwdCBUeXBlc1xyXG4gKiAyLiBSdW50aW1lICsgQ29tcGlsZS1UaW1lIFNhZmV0eTogIEVpbiBTY2hlbWEgZsO8ciBiZWlkZXNcclxuICogMy4gQmVzc2VyZSBGZWhsZXJtZWxkdW5nZW46ICBEZXRhaWxsaWVydGUgVmFsaWRhdGlvbiBFcnJvcnNcclxuICogNC4gU2hhcmVkOiAgS2FubiBpbiBGcm9udGVuZCBVTkQgQmFja2VuZCB2ZXJ3ZW5kZXQgd2VyZGVuXHJcbiAqIDUuIEZ1bmN0aW9uYWw6ICBLZWluIERlY29yYXRvci1NYWdpYywgcHVyZSBGdW5jdGlvbnNcclxuICpcclxuICogVkFMSURBVElPTiBSVUxFUzpcclxuICogLSBlbWFpbDogIFZhbGlkZXMgRW1haWwtRm9ybWF0LCBsb3dlcmNhc2VcclxuICogLSB1c2VybmFtZTogMy0zMCBaZWljaGVuLCBhbHBoYW51bWVyaXNjaCArIHVuZGVyc2NvcmVcclxuICogLSBwYXNzd29yZDogIE1pbiA4IFplaWNoZW4sIEtvbXBsZXhpdMOkdHNyZWdlbG5cclxuICovXHJcblxyXG4vLyBVc2VybmFtZSBQYXR0ZXJuOiAgQWxwaGFudW1lcmlzY2ggKyBVbmRlcnNjb3JlLCBrZWluZSBMZWVyemVpY2hlblxyXG5jb25zdCBVU0VSTkFNRV9SRUdFWCA9IC9eW2EtekEtWjAtOV9dKyQvO1xyXG5cclxuLy8gUGFzc3dvcmQgbXVzcyBlbnRoYWx0ZW46ICBHcm/Dn2J1Y2hzdGFiZSwgS2xlaW5idWNoc3RhYmUsIFphaGxcclxuY29uc3QgUEFTU1dPUkRfUkVHRVggPSAvXig/PS4qW2Etel0pKD89LipbQS1aXSkoPz0uKlxcZCkvO1xyXG5cclxuZXhwb3J0IGNvbnN0IFJlZ2lzdGVyU2NoZW1hID0gei5vYmplY3Qoe1xyXG4gIGVtYWlsOiB6XHJcbiAgICAuc3RyaW5nKClcclxuICAgIC5lbWFpbCgnSW52YWxpZCBlbWFpbCBmb3JtYXQnKVxyXG4gICAgLm1heCgyNTUsICdFbWFpbCBtdXN0IGJlIGF0IG1vc3QgMjU1IGNoYXJhY3RlcnMnKVxyXG4gICAgLnRyYW5zZm9ybSgodmFsKSA9PiB2YWwudG9Mb3dlckNhc2UoKS50cmltKCkpLCAvLyBOb3JtYWxpc2llcnVuZ1xyXG5cclxuICB1c2VybmFtZTogelxyXG4gICAgLnN0cmluZygpXHJcbiAgICAubWluKDMsICdVc2VybmFtZSBtdXN0IGJlIGF0IGxlYXN0IDMgY2hhcmFjdGVycycpXHJcbiAgICAubWF4KDMwLCAnVXNlcm5hbWUgbXVzdCBiZSBhdCBtb3N0IDMwIGNoYXJhY3RlcnMnKVxyXG4gICAgLnJlZ2V4KFxyXG4gICAgICBVU0VSTkFNRV9SRUdFWCxcclxuICAgICAgJ1VzZXJuYW1lIGNhbiBvbmx5IGNvbnRhaW4gbGV0dGVycywgbnVtYmVycywgYW5kIHVuZGVyc2NvcmVzJyxcclxuICAgIClcclxuICAgIC50cmFuc2Zvcm0oKHZhbCkgPT4gdmFsLnRyaW0oKSksXHJcblxyXG4gIHBhc3N3b3JkOiB6XHJcbiAgICAuc3RyaW5nKClcclxuICAgIC5taW4oOCwgJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzJylcclxuICAgIC5tYXgoMTAwLCAnUGFzc3dvcmQgbXVzdCBiZSBhdCBtb3N0IDEwMCBjaGFyYWN0ZXJzJylcclxuICAgIC5yZWdleChcclxuICAgICAgUEFTU1dPUkRfUkVHRVgsXHJcbiAgICAgICdQYXNzd29yZCBtdXN0IGNvbnRhaW4gYXQgbGVhc3Qgb25lIHVwcGVyY2FzZSBsZXR0ZXIsIG9uZSBsb3dlcmNhc2UgbGV0dGVyLCBhbmQgb25lIG51bWJlcicsXHJcbiAgICApLFxyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBUeXBlU2NyaXB0IFR5cGUgYXVzIFNjaGVtYSBnZW5lcmllcnRcclxuICpcclxuICogRXF1aXZhbGVudCB6dTpcclxuICogaW50ZXJmYWNlIFJlZ2lzdGVyRHRvIHtcclxuICogICBlbWFpbDogc3RyaW5nXHJcbiAqICAgdXNlcm5hbWU6IHN0cmluZ1xyXG4gKiAgIHBhc3N3b3JkOiBzdHJpbmdcclxuICogfVxyXG4gKlxyXG4gKiBBQkVSOiBBdXRvbWF0aXNjaCBzeW5jaHJvbiBtaXQgVmFsaWRhdGlvbiBSdWxlcyFcclxuICovXHJcbmV4cG9ydCB0eXBlIFJlZ2lzdGVyRHRvID0gei5pbmZlcjx0eXBlb2YgUmVnaXN0ZXJTY2hlbWE+O1xyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRpb24gRnVuY3Rpb25cclxuICogS2FubiBhdWNoIGF1w59lcmhhbGIgdm9uIE5lc3RKUyB2ZXJ3ZW5kZXQgd2VyZGVuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVSZWdpc3RlckR0byhkYXRhOiB1bmtub3duKTogUmVnaXN0ZXJEdG8ge1xyXG4gIHJldHVybiBSZWdpc3RlclNjaGVtYS5wYXJzZShkYXRhKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNhZmUgVmFsaWRhdGlvbiAod2lyZnQga2VpbmVuIEVycm9yKVxyXG4gKiBHaWJ0IFJlc3VsdC1PYmplY3QgenVyw7xja1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNhZmVWYWxpZGF0ZVJlZ2lzdGVyRHRvKGRhdGE6IHVua25vd24pIHtcclxuICByZXR1cm4gUmVnaXN0ZXJTY2hlbWEuc2FmZVBhcnNlKGRhdGEpO1xyXG59XHJcbiJdLCJ2ZXJzaW9uIjozfQ==