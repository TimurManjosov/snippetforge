{"file":"C:\\Users\\timur\\Programming\\Projects\\snippetforge\\apps\\api\\src\\shared\\filters\\http-exception.filter.spec.ts","mappings":"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","names":[],"sources":["C:\\Users\\timur\\Programming\\Projects\\snippetforge\\apps\\api\\src\\shared\\filters\\http-exception.filter.spec.ts"],"sourcesContent":["// src/shared/filters/http-exception.filter.spec.ts\r\n\r\nimport { HttpException, HttpStatus } from '@nestjs/common';\r\nimport { Test, TestingModule } from '@nestjs/testing';\r\nimport { HttpExceptionFilter } from './http-exception.filter';\r\nimport { ErrorCodes } from '../constants';\r\n\r\ndescribe('HttpExceptionFilter', () => {\r\n  let filter: HttpExceptionFilter;\r\n  let mockResponse: any;\r\n  let mockRequest: any;\r\n  let mockArgumentsHost: any;\r\n\r\n  beforeEach(async () => {\r\n    const module: TestingModule = await Test.createTestingModule({\r\n      providers: [HttpExceptionFilter],\r\n    }).compile();\r\n\r\n    filter = module.get<HttpExceptionFilter>(HttpExceptionFilter);\r\n\r\n    // Mock Response\r\n    mockResponse = {\r\n      status: jest.fn().mockReturnThis(),\r\n      json: jest.fn().mockReturnThis(),\r\n    };\r\n\r\n    // Mock Request\r\n    mockRequest = {\r\n      url: '/api/test',\r\n      method: 'GET',\r\n      ip: '127.0.0.1',\r\n      headers: {\r\n        'user-agent': 'test-agent',\r\n      },\r\n    };\r\n\r\n    // Mock ArgumentsHost\r\n    mockArgumentsHost = {\r\n      switchToHttp: jest.fn().mockReturnValue({\r\n        getResponse: () => mockResponse,\r\n        getRequest: () => mockRequest,\r\n      }),\r\n    };\r\n  });\r\n\r\n  describe('catch', () => {\r\n    it('should handle string exception response', () => {\r\n      const exception = new HttpException('Not found', HttpStatus.NOT_FOUND);\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(mockResponse.status).toHaveBeenCalledWith(404);\r\n      expect(mockResponse.json).toHaveBeenCalledWith({\r\n        success: false,\r\n        error: {\r\n          code: ErrorCodes.RESOURCE_NOT_FOUND,\r\n          message: 'Not found',\r\n          statusCode: 404,\r\n        },\r\n        meta: {\r\n          timestamp: expect.any(String),\r\n          path: '/api/test',\r\n          method: 'GET',\r\n        },\r\n      });\r\n    });\r\n\r\n    it('should handle object exception response', () => {\r\n      const exception = new HttpException(\r\n        {\r\n          message: 'Validation failed',\r\n          error: 'Bad Request',\r\n        },\r\n        HttpStatus.BAD_REQUEST,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(mockResponse.status).toHaveBeenCalledWith(400);\r\n      expect(mockResponse.json).toHaveBeenCalledWith({\r\n        success: false,\r\n        error: {\r\n          code: ErrorCodes.VALIDATION_ERROR,\r\n          message: 'Validation failed',\r\n          statusCode: 400,\r\n        },\r\n        meta: {\r\n          timestamp: expect.any(String),\r\n          path: '/api/test',\r\n          method: 'GET',\r\n        },\r\n      });\r\n    });\r\n\r\n    it('should handle exception with array of messages', () => {\r\n      const exception = new HttpException(\r\n        {\r\n          message: ['Error 1', 'Error 2'],\r\n        },\r\n        HttpStatus.BAD_REQUEST,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(mockResponse.json).toHaveBeenCalledWith({\r\n        success: false,\r\n        error: {\r\n          code: ErrorCodes.VALIDATION_ERROR,\r\n          message: 'Error 1',\r\n          statusCode: 400,\r\n          details: {\r\n            context: {\r\n              messages: ['Error 1', 'Error 2'],\r\n            },\r\n          },\r\n        },\r\n        meta: {\r\n          timestamp: expect.any(String),\r\n          path: '/api/test',\r\n          method: 'GET',\r\n        },\r\n      });\r\n    });\r\n\r\n    it('should handle exception with custom error code', () => {\r\n      const exception = new HttpException(\r\n        {\r\n          message: 'User not found',\r\n          code: ErrorCodes.USER_NOT_FOUND,\r\n        },\r\n        HttpStatus.NOT_FOUND,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(mockResponse.json).toHaveBeenCalledWith({\r\n        success: false,\r\n        error: {\r\n          code: ErrorCodes.USER_NOT_FOUND,\r\n          message: 'User not found',\r\n          statusCode: 404,\r\n        },\r\n        meta: {\r\n          timestamp: expect.any(String),\r\n          path: '/api/test',\r\n          method: 'GET',\r\n        },\r\n      });\r\n    });\r\n\r\n    it('should handle exception with Zod validation errors', () => {\r\n      const exception = new HttpException(\r\n        {\r\n          message: 'Validation failed',\r\n          code: ErrorCodes.VALIDATION_ERROR,\r\n          errors: {\r\n            email: ['Invalid email format'],\r\n            password: ['Too short', 'Must contain number'],\r\n          },\r\n        },\r\n        HttpStatus.BAD_REQUEST,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(mockResponse.json).toHaveBeenCalledWith({\r\n        success: false,\r\n        error: {\r\n          code: ErrorCodes.VALIDATION_ERROR,\r\n          message: 'Validation failed',\r\n          statusCode: 400,\r\n          details: {\r\n            fields: {\r\n              email: ['Invalid email format'],\r\n              password: ['Too short', 'Must contain number'],\r\n            },\r\n          },\r\n        },\r\n        meta: {\r\n          timestamp: expect.any(String),\r\n          path: '/api/test',\r\n          method: 'GET',\r\n        },\r\n      });\r\n    });\r\n\r\n    it('should extract request ID from headers', () => {\r\n      mockRequest.headers['x-request-id'] = 'test-request-id-123';\r\n\r\n      const exception = new HttpException('Error', HttpStatus.BAD_REQUEST);\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(mockResponse.json).toHaveBeenCalledWith({\r\n        success: false,\r\n        error: expect.any(Object),\r\n        meta: {\r\n          timestamp: expect.any(String),\r\n          path: '/api/test',\r\n          method: 'GET',\r\n          requestId: 'test-request-id-123',\r\n        },\r\n      });\r\n    });\r\n\r\n    it('should extract correlation ID if request ID is not present', () => {\r\n      mockRequest.headers['x-correlation-id'] = 'correlation-456';\r\n\r\n      const exception = new HttpException('Error', HttpStatus.BAD_REQUEST);\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(mockResponse.json).toHaveBeenCalledWith({\r\n        success: false,\r\n        error: expect.any(Object),\r\n        meta: {\r\n          timestamp: expect.any(String),\r\n          path: '/api/test',\r\n          method: 'GET',\r\n          requestId: 'correlation-456',\r\n        },\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('error code inference', () => {\r\n    it('should infer AUTH_TOKEN_EXPIRED for 401 with expired message', () => {\r\n      const exception = new HttpException(\r\n        { message: 'Token expired' },\r\n        HttpStatus.UNAUTHORIZED,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.AUTH_TOKEN_EXPIRED);\r\n    });\r\n\r\n    it('should infer AUTH_TOKEN_MISSING for 401 with missing token message', () => {\r\n      const exception = new HttpException(\r\n        { message: 'No token provided' },\r\n        HttpStatus.UNAUTHORIZED,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.AUTH_TOKEN_MISSING);\r\n    });\r\n\r\n    it('should infer AUTH_INVALID_CREDENTIALS for 401 with invalid credentials', () => {\r\n      const exception = new HttpException(\r\n        { message: 'Invalid credentials' },\r\n        HttpStatus.UNAUTHORIZED,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.AUTH_INVALID_CREDENTIALS);\r\n    });\r\n\r\n    it('should infer AUTH_TOKEN_INVALID for generic 401', () => {\r\n      const exception = new HttpException(\r\n        { message: 'Unauthorized' },\r\n        HttpStatus.UNAUTHORIZED,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.AUTH_TOKEN_INVALID);\r\n    });\r\n\r\n    it('should infer AUTH_INSUFFICIENT_ROLE for 403 with role message', () => {\r\n      const exception = new HttpException(\r\n        { message: 'Insufficient role' },\r\n        HttpStatus.FORBIDDEN,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.AUTH_INSUFFICIENT_ROLE);\r\n    });\r\n\r\n    it('should infer AUTH_ACCESS_DENIED for generic 403', () => {\r\n      const exception = new HttpException(\r\n        { message: 'Forbidden' },\r\n        HttpStatus.FORBIDDEN,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.AUTH_ACCESS_DENIED);\r\n    });\r\n\r\n    it('should infer USER_EMAIL_EXISTS for 409 with email message', () => {\r\n      const exception = new HttpException(\r\n        { message: 'Email already exists' },\r\n        HttpStatus.CONFLICT,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.USER_EMAIL_EXISTS);\r\n    });\r\n\r\n    it('should infer USER_USERNAME_EXISTS for 409 with username message', () => {\r\n      const exception = new HttpException(\r\n        { message: 'Username already taken' },\r\n        HttpStatus.CONFLICT,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.USER_USERNAME_EXISTS);\r\n    });\r\n\r\n    it('should infer USER_NOT_FOUND for 404 with user message', () => {\r\n      const exception = new HttpException(\r\n        { message: 'User not found' },\r\n        HttpStatus.NOT_FOUND,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.USER_NOT_FOUND);\r\n    });\r\n\r\n    it('should use default code for unknown status', () => {\r\n      const exception = new HttpException(\r\n        'Internal Server Error',\r\n        HttpStatus.INTERNAL_SERVER_ERROR,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      const response = mockResponse.json.mock.calls[0][0];\r\n      expect(response.error.code).toBe(ErrorCodes.SERVER_ERROR);\r\n    });\r\n  });\r\n\r\n  describe('logging behavior', () => {\r\n    it('should log error level for 5xx errors', () => {\r\n      const loggerErrorSpy = jest.spyOn(filter['logger'], 'error');\r\n\r\n      const exception = new HttpException(\r\n        'Internal Error',\r\n        HttpStatus.INTERNAL_SERVER_ERROR,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(loggerErrorSpy).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should log warn level for 401 errors', () => {\r\n      const loggerWarnSpy = jest.spyOn(filter['logger'], 'warn');\r\n\r\n      const exception = new HttpException(\r\n        'Unauthorized',\r\n        HttpStatus.UNAUTHORIZED,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(loggerWarnSpy).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should log warn level for 403 errors', () => {\r\n      const loggerWarnSpy = jest.spyOn(filter['logger'], 'warn');\r\n\r\n      const exception = new HttpException('Forbidden', HttpStatus.FORBIDDEN);\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(loggerWarnSpy).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should log debug level for 4xx errors (except 401/403)', () => {\r\n      const loggerDebugSpy = jest.spyOn(filter['logger'], 'debug');\r\n\r\n      const exception = new HttpException(\r\n        'Bad Request',\r\n        HttpStatus.BAD_REQUEST,\r\n      );\r\n\r\n      filter.catch(exception, mockArgumentsHost);\r\n\r\n      expect(loggerDebugSpy).toHaveBeenCalled();\r\n    });\r\n  });\r\n});\r\n"],"version":3}