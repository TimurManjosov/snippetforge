{"file":"C:\\Users\\timur\\Programming\\Projects\\snippetforge\\apps\\api\\src\\modules\\auth\\decorators\\current-user.decorator.ts","mappings":";AAAA,wDAAwD;;;AAExD,2CAAwE;AAIxE;;;;;;;;;;;;;;;;;;;;;;;;GAwBG;AACU,QAAA,WAAW,GAAG,IAAA,6BAAoB;AAC7C;;;;GAIG;AACH,CAAC,IAAgC,EAAE,GAAqB,EAAE,EAAE;IAC1D,MAAM,OAAO,GAAG,GAAG,CAAC,YAAY,EAAE,CAAC,UAAU,EAAW,CAAC;IACzD,MAAM,IAAI,GAAG,OAAO,CAAC,IAA4B,CAAC;IAElD,6DAA6D;IAC7D,IAAI,CAAC,IAAI,EAAE,CAAC;QACV,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,iDAAiD;IACjD,IAAI,IAAI,EAAE,CAAC;QACT,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;IACpB,CAAC;IAED,gCAAgC;IAChC,OAAO,IAAI,CAAC;AACd,CAAC,CACF,CAAC","names":[],"sources":["C:\\Users\\timur\\Programming\\Projects\\snippetforge\\apps\\api\\src\\modules\\auth\\decorators\\current-user.decorator.ts"],"sourcesContent":["// src/modules/auth/decorators/current-user.decorator.ts\r\n\r\nimport { createParamDecorator, ExecutionContext } from '@nestjs/common';\r\nimport { Request } from 'express';\r\nimport { type SafeUser } from '../../users';\r\n\r\n/**\r\n * @CurrentUser() Decorator - Injiziert aktuellen User in Controller-Methode\r\n *\r\n * WARUM als Decorator statt request.user?\r\n * 1. Typsicherheit:  Decorator gibt SafeUser zur端ck, nicht any\r\n * 2. Clean Code: Controller-Methode zeigt klar welche Daten sie braucht\r\n * 3. Testbar: Decorator kann gemockt werden\r\n *\r\n * VERWENDUNG:\r\n * @Get('me')\r\n * @UseGuards(JwtAuthGuard)\r\n * getProfile(@CurrentUser() user: SafeUser) {\r\n *   return user\r\n * }\r\n *\r\n * // Mit Property-Zugriff\r\n * @Get('my-email')\r\n * @UseGuards(JwtAuthGuard)\r\n * getEmail(@CurrentUser('email') email: string) {\r\n *   return { email }\r\n * }\r\n *\r\n * VORAUSSETZUNG: JwtAuthGuard muss aktiv sein!\r\n * Sonst ist request.user undefined\r\n */\r\nexport const CurrentUser = createParamDecorator(\r\n  /**\r\n   * @param data - Optionaler Property-Name (z.B. 'email', 'id')\r\n   * @param ctx - Execution Context\r\n   * @returns User oder User-Property\r\n   */\r\n  (data: keyof SafeUser | undefined, ctx: ExecutionContext) => {\r\n    const request = ctx.switchToHttp().getRequest<Request>();\r\n    const user = request.user as SafeUser | undefined;\r\n\r\n    // Wenn kein User (Guard nicht aktiv?), undefined zur端ckgeben\r\n    if (!user) {\r\n      return undefined;\r\n    }\r\n\r\n    // Wenn Property angefragt, nur diese zur端ckgeben\r\n    if (data) {\r\n      return user[data];\r\n    }\r\n\r\n    // Sonst ganzen User zur端ckgeben\r\n    return user;\r\n  },\r\n);\r\n"],"version":3}