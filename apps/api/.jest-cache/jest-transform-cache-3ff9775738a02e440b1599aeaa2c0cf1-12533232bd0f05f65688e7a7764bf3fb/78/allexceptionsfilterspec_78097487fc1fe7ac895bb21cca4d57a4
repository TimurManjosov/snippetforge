cf0cfaa2aa8ed3d463a2b33083f7e787
"use strict";
// src/shared/filters/all-exceptions.filter.spec.ts
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@nestjs/common");
const testing_1 = require("@nestjs/testing");
const all_exceptions_filter_1 = require("./all-exceptions.filter");
const constants_1 = require("../constants");
describe('AllExceptionsFilter', () => {
    let filter;
    let mockResponse;
    let mockRequest;
    let mockArgumentsHost;
    let originalNodeEnv;
    beforeEach(async () => {
        const module = await testing_1.Test.createTestingModule({
            providers: [all_exceptions_filter_1.AllExceptionsFilter],
        }).compile();
        filter = module.get(all_exceptions_filter_1.AllExceptionsFilter);
        // Mock Response
        mockResponse = {
            status: jest.fn().mockReturnThis(),
            json: jest.fn().mockReturnThis(),
        };
        // Mock Request
        mockRequest = {
            url: '/api/test',
            method: 'POST',
            ip: '127.0.0.1',
            headers: {
                'user-agent': 'test-agent',
            },
        };
        // Mock ArgumentsHost
        mockArgumentsHost = {
            switchToHttp: jest.fn().mockReturnValue({
                getResponse: () => mockResponse,
                getRequest: () => mockRequest,
            }),
        };
        // Save original NODE_ENV
        originalNodeEnv = process.env.NODE_ENV;
    });
    afterEach(() => {
        // Restore original NODE_ENV
        if (originalNodeEnv !== undefined) {
            process.env.NODE_ENV = originalNodeEnv;
        }
        else {
            delete process.env.NODE_ENV;
        }
    });
    describe('catch - production mode', () => {
        beforeEach(() => {
            process.env.NODE_ENV = 'production';
            // Recreate filter to pick up new NODE_ENV
            filter = new all_exceptions_filter_1.AllExceptionsFilter();
        });
        it('should return generic message in production for TypeError', () => {
            const exception = new TypeError('Cannot read property of undefined');
            filter.catch(exception, mockArgumentsHost);
            expect(mockResponse.status).toHaveBeenCalledWith(500);
            expect(mockResponse.json).toHaveBeenCalledWith({
                success: false,
                error: {
                    code: constants_1.ErrorCodes.SERVER_ERROR,
                    message: 'An unexpected error occurred. Please try again later.',
                    statusCode: 500,
                },
                meta: {
                    timestamp: expect.any(String),
                    path: '/api/test',
                    method: 'POST',
                },
            });
        });
        it('should not leak error details in production', () => {
            const exception = new Error('Database connection failed at /home/user/app/db.js:123');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.message).toBe('An unexpected error occurred. Please try again later.');
            expect(response.error.message).not.toContain('/home/user/app');
            expect(response.error.message).not.toContain('db.js');
        });
        it('should log error with full details in production', () => {
            const loggerErrorSpy = jest.spyOn(filter['logger'], 'error');
            const exception = new Error('Sensitive internal error');
            filter.catch(exception, mockArgumentsHost);
            expect(loggerErrorSpy).toHaveBeenCalled();
            const logCall = loggerErrorSpy.mock.calls[0];
            expect(logCall[0]).toContain('Sensitive internal error');
        });
    });
    describe('catch - development mode', () => {
        beforeEach(() => {
            process.env.NODE_ENV = 'development';
            // Recreate filter to pick up new NODE_ENV
            filter = new all_exceptions_filter_1.AllExceptionsFilter();
        });
        it('should return sanitized error message in development', () => {
            const exception = new Error('Database query failed');
            filter.catch(exception, mockArgumentsHost);
            expect(mockResponse.status).toHaveBeenCalledWith(500);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.message).toBe('Database query failed');
        });
        it('should sanitize file paths in development', () => {
            const exception = new Error('Failed at /home/user/project/src/file.ts:123');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.message).toContain('[REDACTED]');
            expect(response.error.message).not.toContain('/home/user/project');
        });
        it('should sanitize Windows file paths in development', () => {
            const exception = new Error('Error in C:\\Users\\Project\\app.js');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.message).toContain('[REDACTED]');
            expect(response.error.message).not.toContain('C:\\Users\\Project');
        });
        it('should sanitize connection strings in development', () => {
            const exception = new Error('Failed to connect to postgresql://user:pass@localhost:5432/db');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.message).toContain('[REDACTED]');
            expect(response.error.message).not.toContain('user:pass@localhost');
        });
        it('should truncate very long error messages', () => {
            const longMessage = 'Error: ' + 'x'.repeat(600);
            const exception = new Error(longMessage);
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.message.length).toBeLessThanOrEqual(500);
        });
    });
    describe('error type identification', () => {
        beforeEach(() => {
            process.env.NODE_ENV = 'development';
            filter = new all_exceptions_filter_1.AllExceptionsFilter();
        });
        it('should identify JWT token invalid error', () => {
            const exception = new Error('Invalid token');
            exception.name = 'JsonWebTokenError';
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.AUTH_TOKEN_INVALID);
        });
        it('should identify JWT token expired error', () => {
            const exception = new Error('Token expired');
            exception.name = 'TokenExpiredError';
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.AUTH_TOKEN_EXPIRED);
        });
        it('should identify JWT NotBeforeError', () => {
            const exception = new Error('Token not active');
            exception.name = 'NotBeforeError';
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.AUTH_TOKEN_INVALID);
        });
        it('should identify database connection error', () => {
            const exception = new Error('ECONNREFUSED to database');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.SERVER_DATABASE_ERROR);
        });
        it('should identify postgres error', () => {
            const exception = new Error('postgres connection failed');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.SERVER_DATABASE_ERROR);
        });
        it('should identify unique constraint violation', () => {
            const exception = new Error('duplicate key value violates unique constraint');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.RESOURCE_ALREADY_EXISTS);
        });
        it('should identify JSON parse error', () => {
            const exception = new SyntaxError('Unexpected token in JSON');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.VALIDATION_ERROR);
        });
        it('should use default code for unknown error', () => {
            const exception = new Error('Unknown error');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.error.code).toBe(constants_1.ErrorCodes.SERVER_ERROR);
        });
    });
    describe('HttpException handling', () => {
        it('should handle HttpException with warning', () => {
            const loggerWarnSpy = jest.spyOn(filter['logger'], 'warn');
            const exception = new common_1.HttpException('Not Found', common_1.HttpStatus.NOT_FOUND);
            filter.catch(exception, mockArgumentsHost);
            expect(loggerWarnSpy).toHaveBeenCalledWith('HttpException caught by AllExceptionsFilter - this should not happen');
            expect(mockResponse.status).toHaveBeenCalledWith(404);
        });
    });
    describe('request ID extraction', () => {
        beforeEach(() => {
            process.env.NODE_ENV = 'development';
            filter = new all_exceptions_filter_1.AllExceptionsFilter();
        });
        it('should extract x-request-id from headers', () => {
            mockRequest.headers['x-request-id'] = 'req-123';
            const exception = new Error('Test error');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.meta.requestId).toBe('req-123');
        });
        it('should extract x-correlation-id if x-request-id is not present', () => {
            mockRequest.headers['x-correlation-id'] = 'corr-456';
            const exception = new Error('Test error');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.meta.requestId).toBe('corr-456');
        });
        it('should not include requestId if neither header is present', () => {
            const exception = new Error('Test error');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.meta.requestId).toBeUndefined();
        });
    });
    describe('non-Error exception handling', () => {
        beforeEach(() => {
            process.env.NODE_ENV = 'development';
            filter = new all_exceptions_filter_1.AllExceptionsFilter();
        });
        it('should handle string throws', () => {
            const exception = 'string error';
            filter.catch(exception, mockArgumentsHost);
            expect(mockResponse.status).toHaveBeenCalledWith(500);
            expect(mockResponse.json).toHaveBeenCalled();
        });
        it('should log string throws appropriately', () => {
            const loggerErrorSpy = jest.spyOn(filter['logger'], 'error');
            const exception = 'string error';
            filter.catch(exception, mockArgumentsHost);
            expect(loggerErrorSpy).toHaveBeenCalled();
            const logCall = loggerErrorSpy.mock.calls[0];
            expect(logCall[0]).toContain('Unknown exception type');
            expect(logCall[1]).toBe('string error');
        });
    });
    describe('logging', () => {
        beforeEach(() => {
            process.env.NODE_ENV = 'development';
            filter = new all_exceptions_filter_1.AllExceptionsFilter();
        });
        it('should always log with stack trace for Error instances', () => {
            const loggerErrorSpy = jest.spyOn(filter['logger'], 'error');
            const exception = new Error('Test error with stack');
            filter.catch(exception, mockArgumentsHost);
            expect(loggerErrorSpy).toHaveBeenCalled();
            const logCall = loggerErrorSpy.mock.calls[0];
            expect(logCall[1]).toBeTruthy(); // Stack trace
            expect(logCall[2]).toContain('method'); // Log context
        });
        it('should include request metadata in log context', () => {
            const loggerErrorSpy = jest.spyOn(filter['logger'], 'error');
            const exception = new Error('Test error');
            filter.catch(exception, mockArgumentsHost);
            const logContextStr = loggerErrorSpy.mock.calls[0][2];
            const logContext = JSON.parse(logContextStr);
            expect(logContext).toMatchObject({
                method: 'POST',
                url: '/api/test',
                ip: '127.0.0.1',
                userAgent: 'test-agent',
                timestamp: expect.any(String),
            });
        });
        it('should truncate long user agents', () => {
            const loggerErrorSpy = jest.spyOn(filter['logger'], 'error');
            const longUserAgent = 'x'.repeat(200);
            mockRequest.headers['user-agent'] = longUserAgent;
            const exception = new Error('Test error');
            filter.catch(exception, mockArgumentsHost);
            const logContextStr = loggerErrorSpy.mock.calls[0][2];
            const logContext = JSON.parse(logContextStr);
            expect(logContext.userAgent.length).toBe(100);
        });
    });
    describe('response format', () => {
        beforeEach(() => {
            process.env.NODE_ENV = 'development';
            filter = new all_exceptions_filter_1.AllExceptionsFilter();
        });
        it('should never include stack trace in response', () => {
            const exception = new Error('Test error');
            exception.stack = 'Error: Test error\n    at something...';
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(JSON.stringify(response)).not.toContain(exception.stack);
        });
        it('should always set success to false', () => {
            const exception = new Error('Test error');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.success).toBe(false);
        });
        it('should include proper metadata', () => {
            const exception = new Error('Test error');
            filter.catch(exception, mockArgumentsHost);
            const response = mockResponse.json.mock.calls[0][0];
            expect(response.meta).toMatchObject({
                timestamp: expect.any(String),
                path: '/api/test',
                method: 'POST',
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aW11clxcUHJvZ3JhbW1pbmdcXFByb2plY3RzXFxzbmlwcGV0Zm9yZ2VcXGFwcHNcXGFwaVxcc3JjXFxzaGFyZWRcXGZpbHRlcnNcXGFsbC1leGNlcHRpb25zLmZpbHRlci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQSxtREFBbUQ7O0FBRW5ELDJDQUEyRDtBQUMzRCw2Q0FBc0Q7QUFDdEQsbUVBQThEO0FBQzlELDRDQUEwQztBQUUxQyxRQUFRLENBQUMscUJBQXFCLEVBQUUsR0FBRyxFQUFFO0lBQ25DLElBQUksTUFBMkIsQ0FBQztJQUNoQyxJQUFJLFlBQWlCLENBQUM7SUFDdEIsSUFBSSxXQUFnQixDQUFDO0lBQ3JCLElBQUksaUJBQXNCLENBQUM7SUFDM0IsSUFBSSxlQUFtQyxDQUFDO0lBRXhDLFVBQVUsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNwQixNQUFNLE1BQU0sR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDM0QsU0FBUyxFQUFFLENBQUMsMkNBQW1CLENBQUM7U0FDakMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBRWIsTUFBTSxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQXNCLDJDQUFtQixDQUFDLENBQUM7UUFFOUQsZ0JBQWdCO1FBQ2hCLFlBQVksR0FBRztZQUNiLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsY0FBYyxFQUFFO1lBQ2xDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsY0FBYyxFQUFFO1NBQ2pDLENBQUM7UUFFRixlQUFlO1FBQ2YsV0FBVyxHQUFHO1lBQ1osR0FBRyxFQUFFLFdBQVc7WUFDaEIsTUFBTSxFQUFFLE1BQU07WUFDZCxFQUFFLEVBQUUsV0FBVztZQUNmLE9BQU8sRUFBRTtnQkFDUCxZQUFZLEVBQUUsWUFBWTthQUMzQjtTQUNGLENBQUM7UUFFRixxQkFBcUI7UUFDckIsaUJBQWlCLEdBQUc7WUFDbEIsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FB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QUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7WUFDeEMsTUFBTSxTQUFTLEdBQUcsSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFMUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFTLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztZQUUzQyxNQUFNLFFBQVEsR0FBRyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDcEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxhQUFhLENBQUM7Z0JBQ2xDLFNBQVMsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQztnQkFDN0IsSUFBSSxFQUFFLFdBQVc7Z0JBQ2pCLE1BQU0sRUFBRSxNQUFNO2FBQ2YsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGltdXJcXFByb2dyYW1taW5nXFxQcm9qZWN0c1xcc25pcHBldGZvcmdlXFxhcHBzXFxhcGlcXHNyY1xcc2hhcmVkXFxmaWx0ZXJzXFxhbGwtZXhjZXB0aW9ucy5maWx0ZXIuc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvc2hhcmVkL2ZpbHRlcnMvYWxsLWV4Y2VwdGlvbnMuZmlsdGVyLnNwZWMudHNcclxuXHJcbmltcG9ydCB7IEh0dHBFeGNlcHRpb24sIEh0dHBTdGF0dXMgfSBmcm9tICdAbmVzdGpzL2NvbW1vbic7XHJcbmltcG9ydCB7IFRlc3QsIFRlc3RpbmdNb2R1bGUgfSBmcm9tICdAbmVzdGpzL3Rlc3RpbmcnO1xyXG5pbXBvcnQgeyBBbGxFeGNlcHRpb25zRmlsdGVyIH0gZnJvbSAnLi9hbGwtZXhjZXB0aW9ucy5maWx0ZXInO1xyXG5pbXBvcnQgeyBFcnJvckNvZGVzIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcclxuXHJcbmRlc2NyaWJlKCdBbGxFeGNlcHRpb25zRmlsdGVyJywgKCkgPT4ge1xyXG4gIGxldCBmaWx0ZXI6IEFsbEV4Y2VwdGlvbnNGaWx0ZXI7XHJcbiAgbGV0IG1vY2tSZXNwb25zZTogYW55O1xyXG4gIGxldCBtb2NrUmVxdWVzdDogYW55O1xyXG4gIGxldCBtb2NrQXJndW1lbnRzSG9zdDogYW55O1xyXG4gIGxldCBvcmlnaW5hbE5vZGVFbnY6IHN0cmluZyB8IHVuZGVmaW5lZDtcclxuXHJcbiAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBtb2R1bGU6IFRlc3RpbmdNb2R1bGUgPSBhd2FpdCBUZXN0LmNyZWF0ZVRlc3RpbmdNb2R1bGUoe1xyXG4gICAgICBwcm92aWRlcnM6IFtBbGxFeGNlcHRpb25zRmlsdGVyXSxcclxuICAgIH0pLmNvbXBpbGUoKTtcclxuXHJcbiAgICBmaWx0ZXIgPSBtb2R1bGUuZ2V0PEFsbEV4Y2VwdGlvbnNGaWx0ZXI+KEFsbEV4Y2VwdGlvbnNGaWx0ZXIpO1xyXG5cclxuICAgIC8vIE1vY2sgUmVzcG9uc2VcclxuICAgIG1vY2tSZXNwb25zZSA9IHtcclxuICAgICAgc3RhdHVzOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcclxuICAgICAganNvbjogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIE1vY2sgUmVxdWVzdFxyXG4gICAgbW9ja1JlcXVlc3QgPSB7XHJcbiAgICAgIHVybDogJy9hcGkvdGVzdCcsXHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBpcDogJzEyNy4wLjAuMScsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAndXNlci1hZ2VudCc6ICd0ZXN0LWFnZW50JyxcclxuICAgICAgfSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gTW9jayBBcmd1bWVudHNIb3N0XHJcbiAgICBtb2NrQXJndW1lbnRzSG9zdCA9IHtcclxuICAgICAgc3dpdGNoVG9IdHRwOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcclxuICAgICAgICBnZXRSZXNwb25zZTogKCkgPT4gbW9ja1Jlc3BvbnNlLFxyXG4gICAgICAgIGdldFJlcXVlc3Q6ICgpID0+IG1vY2tSZXF1ZXN0LFxyXG4gICAgICB9KSxcclxuICAgIH07XHJcblxyXG4gICAgLy8gU2F2ZSBvcmlnaW5hbCBOT0RFX0VOVlxyXG4gICAgb3JpZ2luYWxOb2RlRW52ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlY7XHJcbiAgfSk7XHJcblxyXG4gIGFmdGVyRWFjaCgoKSA9PiB7XHJcbiAgICAvLyBSZXN0b3JlIG9yaWdpbmFsIE5PREVfRU5WXHJcbiAgICBpZiAob3JpZ2luYWxOb2RlRW52ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBvcmlnaW5hbE5vZGVFbnY7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkZWxldGUgcHJvY2Vzcy5lbnYuTk9ERV9FTlY7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdjYXRjaCAtIHByb2R1Y3Rpb24gbW9kZScsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdwcm9kdWN0aW9uJztcclxuICAgICAgLy8gUmVjcmVhdGUgZmlsdGVyIHRvIHBpY2sgdXAgbmV3IE5PREVfRU5WXHJcbiAgICAgIGZpbHRlciA9IG5ldyBBbGxFeGNlcHRpb25zRmlsdGVyKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBnZW5lcmljIG1lc3NhZ2UgaW4gcHJvZHVjdGlvbiBmb3IgVHlwZUVycm9yJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSBuZXcgVHlwZUVycm9yKCdDYW5ub3QgcmVhZCBwcm9wZXJ0eSBvZiB1bmRlZmluZWQnKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg1MDApO1xyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjoge1xyXG4gICAgICAgICAgY29kZTogRXJyb3JDb2Rlcy5TRVJWRVJfRVJST1IsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nLFxyXG4gICAgICAgICAgc3RhdHVzQ29kZTogNTAwLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbWV0YToge1xyXG4gICAgICAgICAgdGltZXN0YW1wOiBleHBlY3QuYW55KFN0cmluZyksXHJcbiAgICAgICAgICBwYXRoOiAnL2FwaS90ZXN0JyxcclxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBub3QgbGVhayBlcnJvciBkZXRhaWxzIGluIHByb2R1Y3Rpb24nLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcihcclxuICAgICAgICAnRGF0YWJhc2UgY29ubmVjdGlvbiBmYWlsZWQgYXQgL2hvbWUvdXNlci9hcHAvZGIuanM6MTIzJyxcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpLnRvQmUoXHJcbiAgICAgICAgJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcclxuICAgICAgKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpLm5vdC50b0NvbnRhaW4oJy9ob21lL3VzZXIvYXBwJyk7XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5tZXNzYWdlKS5ub3QudG9Db250YWluKCdkYi5qcycpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBsb2cgZXJyb3Igd2l0aCBmdWxsIGRldGFpbHMgaW4gcHJvZHVjdGlvbicsICgpID0+IHtcclxuICAgICAgY29uc3QgbG9nZ2VyRXJyb3JTcHkgPSBqZXN0LnNweU9uKGZpbHRlclsnbG9nZ2VyJ10sICdlcnJvcicpO1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSBuZXcgRXJyb3IoJ1NlbnNpdGl2ZSBpbnRlcm5hbCBlcnJvcicpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgZXhwZWN0KGxvZ2dlckVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgIGNvbnN0IGxvZ0NhbGwgPSBsb2dnZXJFcnJvclNweS5tb2NrLmNhbGxzWzBdO1xyXG4gICAgICBleHBlY3QobG9nQ2FsbFswXSkudG9Db250YWluKCdTZW5zaXRpdmUgaW50ZXJuYWwgZXJyb3InKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnY2F0Y2ggLSBkZXZlbG9wbWVudCBtb2RlJywgKCkgPT4ge1xyXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ2RldmVsb3BtZW50JztcclxuICAgICAgLy8gUmVjcmVhdGUgZmlsdGVyIHRvIHBpY2sgdXAgbmV3IE5PREVfRU5WXHJcbiAgICAgIGZpbHRlciA9IG5ldyBBbGxFeGNlcHRpb25zRmlsdGVyKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBzYW5pdGl6ZWQgZXJyb3IgbWVzc2FnZSBpbiBkZXZlbG9wbWVudCcsICgpID0+IHtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdEYXRhYmFzZSBxdWVyeSBmYWlsZWQnKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg1MDApO1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IG1vY2tSZXNwb25zZS5qc29uLm1vY2suY2FsbHNbMF1bMF07XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5tZXNzYWdlKS50b0JlKCdEYXRhYmFzZSBxdWVyeSBmYWlsZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgc2FuaXRpemUgZmlsZSBwYXRocyBpbiBkZXZlbG9wbWVudCcsICgpID0+IHtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKFxyXG4gICAgICAgICdGYWlsZWQgYXQgL2hvbWUvdXNlci9wcm9qZWN0L3NyYy9maWxlLnRzOjEyMycsXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBmaWx0ZXIuY2F0Y2goZXhjZXB0aW9uLCBtb2NrQXJndW1lbnRzSG9zdCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IG1vY2tSZXNwb25zZS5qc29uLm1vY2suY2FsbHNbMF1bMF07XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ1tSRURBQ1RFRF0nKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpLm5vdC50b0NvbnRhaW4oJy9ob21lL3VzZXIvcHJvamVjdCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBXaW5kb3dzIGZpbGUgcGF0aHMgaW4gZGV2ZWxvcG1lbnQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcignRXJyb3IgaW4gQzpcXFxcVXNlcnNcXFxcUHJvamVjdFxcXFxhcHAuanMnKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpLnRvQ29udGFpbignW1JFREFDVEVEXScpO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuZXJyb3IubWVzc2FnZSkubm90LnRvQ29udGFpbignQzpcXFxcVXNlcnNcXFxcUHJvamVjdCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBjb25uZWN0aW9uIHN0cmluZ3MgaW4gZGV2ZWxvcG1lbnQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcihcclxuICAgICAgICAnRmFpbGVkIHRvIGNvbm5lY3QgdG8gcG9zdGdyZXNxbDovL3VzZXI6cGFzc0Bsb2NhbGhvc3Q6NTQzMi9kYicsXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBmaWx0ZXIuY2F0Y2goZXhjZXB0aW9uLCBtb2NrQXJndW1lbnRzSG9zdCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IG1vY2tSZXNwb25zZS5qc29uLm1vY2suY2FsbHNbMF1bMF07XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ1tSRURBQ1RFRF0nKTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UpLm5vdC50b0NvbnRhaW4oJ3VzZXI6cGFzc0Bsb2NhbGhvc3QnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdHJ1bmNhdGUgdmVyeSBsb25nIGVycm9yIG1lc3NhZ2VzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBsb25nTWVzc2FnZSA9ICdFcnJvcjogJyArICd4Jy5yZXBlYXQoNjAwKTtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKGxvbmdNZXNzYWdlKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLm1lc3NhZ2UubGVuZ3RoKS50b0JlTGVzc1RoYW5PckVxdWFsKDUwMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2Vycm9yIHR5cGUgaWRlbnRpZmljYXRpb24nLCAoKSA9PiB7XHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnZGV2ZWxvcG1lbnQnO1xyXG4gICAgICBmaWx0ZXIgPSBuZXcgQWxsRXhjZXB0aW9uc0ZpbHRlcigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBKV1QgdG9rZW4gaW52YWxpZCBlcnJvcicsICgpID0+IHtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdJbnZhbGlkIHRva2VuJyk7XHJcbiAgICAgIGV4Y2VwdGlvbi5uYW1lID0gJ0pzb25XZWJUb2tlbkVycm9yJztcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLmNvZGUpLnRvQmUoRXJyb3JDb2Rlcy5BVVRIX1RPS0VOX0lOVkFMSUQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBKV1QgdG9rZW4gZXhwaXJlZCBlcnJvcicsICgpID0+IHtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdUb2tlbiBleHBpcmVkJyk7XHJcbiAgICAgIGV4Y2VwdGlvbi5uYW1lID0gJ1Rva2VuRXhwaXJlZEVycm9yJztcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLmNvZGUpLnRvQmUoRXJyb3JDb2Rlcy5BVVRIX1RPS0VOX0VYUElSRUQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBKV1QgTm90QmVmb3JlRXJyb3InLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcignVG9rZW4gbm90IGFjdGl2ZScpO1xyXG4gICAgICBleGNlcHRpb24ubmFtZSA9ICdOb3RCZWZvcmVFcnJvcic7XHJcblxyXG4gICAgICBmaWx0ZXIuY2F0Y2goZXhjZXB0aW9uLCBtb2NrQXJndW1lbnRzSG9zdCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IG1vY2tSZXNwb25zZS5qc29uLm1vY2suY2FsbHNbMF1bMF07XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5jb2RlKS50b0JlKEVycm9yQ29kZXMuQVVUSF9UT0tFTl9JTlZBTElEKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgZGF0YWJhc2UgY29ubmVjdGlvbiBlcnJvcicsICgpID0+IHtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdFQ09OTlJFRlVTRUQgdG8gZGF0YWJhc2UnKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLmNvZGUpLnRvQmUoRXJyb3JDb2Rlcy5TRVJWRVJfREFUQUJBU0VfRVJST1IpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBwb3N0Z3JlcyBlcnJvcicsICgpID0+IHtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdwb3N0Z3JlcyBjb25uZWN0aW9uIGZhaWxlZCcpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBtb2NrUmVzcG9uc2UuanNvbi5tb2NrLmNhbGxzWzBdWzBdO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuZXJyb3IuY29kZSkudG9CZShFcnJvckNvZGVzLlNFUlZFUl9EQVRBQkFTRV9FUlJPUik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IHVuaXF1ZSBjb25zdHJhaW50IHZpb2xhdGlvbicsICgpID0+IHtcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdkdXBsaWNhdGUga2V5IHZhbHVlIHZpb2xhdGVzIHVuaXF1ZSBjb25zdHJhaW50Jyk7XHJcblxyXG4gICAgICBmaWx0ZXIuY2F0Y2goZXhjZXB0aW9uLCBtb2NrQXJndW1lbnRzSG9zdCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IG1vY2tSZXNwb25zZS5qc29uLm1vY2suY2FsbHNbMF1bMF07XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5lcnJvci5jb2RlKS50b0JlKEVycm9yQ29kZXMuUkVTT1VSQ0VfQUxSRUFEWV9FWElTVFMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBKU09OIHBhcnNlIGVycm9yJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSBuZXcgU3ludGF4RXJyb3IoJ1VuZXhwZWN0ZWQgdG9rZW4gaW4gSlNPTicpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBtb2NrUmVzcG9uc2UuanNvbi5tb2NrLmNhbGxzWzBdWzBdO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UuZXJyb3IuY29kZSkudG9CZShFcnJvckNvZGVzLlZBTElEQVRJT05fRVJST1IpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB1c2UgZGVmYXVsdCBjb2RlIGZvciB1bmtub3duIGVycm9yJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSBuZXcgRXJyb3IoJ1Vua25vd24gZXJyb3InKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLmVycm9yLmNvZGUpLnRvQmUoRXJyb3JDb2Rlcy5TRVJWRVJfRVJST1IpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdIdHRwRXhjZXB0aW9uIGhhbmRsaW5nJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgSHR0cEV4Y2VwdGlvbiB3aXRoIHdhcm5pbmcnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGxvZ2dlcldhcm5TcHkgPSBqZXN0LnNweU9uKGZpbHRlclsnbG9nZ2VyJ10sICd3YXJuJyk7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBIdHRwRXhjZXB0aW9uKCdOb3QgRm91bmQnLCBIdHRwU3RhdHVzLk5PVF9GT1VORCk7XHJcblxyXG4gICAgICBmaWx0ZXIuY2F0Y2goZXhjZXB0aW9uLCBtb2NrQXJndW1lbnRzSG9zdCk7XHJcblxyXG4gICAgICBleHBlY3QobG9nZ2VyV2FyblNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgJ0h0dHBFeGNlcHRpb24gY2F1Z2h0IGJ5IEFsbEV4Y2VwdGlvbnNGaWx0ZXIgLSB0aGlzIHNob3VsZCBub3QgaGFwcGVuJyxcclxuICAgICAgKTtcclxuICAgICAgZXhwZWN0KG1vY2tSZXNwb25zZS5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKDQwNCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ3JlcXVlc3QgSUQgZXh0cmFjdGlvbicsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdkZXZlbG9wbWVudCc7XHJcbiAgICAgIGZpbHRlciA9IG5ldyBBbGxFeGNlcHRpb25zRmlsdGVyKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGV4dHJhY3QgeC1yZXF1ZXN0LWlkIGZyb20gaGVhZGVycycsICgpID0+IHtcclxuICAgICAgbW9ja1JlcXVlc3QuaGVhZGVyc1sneC1yZXF1ZXN0LWlkJ10gPSAncmVxLTEyMyc7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcignVGVzdCBlcnJvcicpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBtb2NrUmVzcG9uc2UuanNvbi5tb2NrLmNhbGxzWzBdWzBdO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UubWV0YS5yZXF1ZXN0SWQpLnRvQmUoJ3JlcS0xMjMnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZXh0cmFjdCB4LWNvcnJlbGF0aW9uLWlkIGlmIHgtcmVxdWVzdC1pZCBpcyBub3QgcHJlc2VudCcsICgpID0+IHtcclxuICAgICAgbW9ja1JlcXVlc3QuaGVhZGVyc1sneC1jb3JyZWxhdGlvbi1pZCddID0gJ2NvcnItNDU2JztcclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdUZXN0IGVycm9yJyk7XHJcblxyXG4gICAgICBmaWx0ZXIuY2F0Y2goZXhjZXB0aW9uLCBtb2NrQXJndW1lbnRzSG9zdCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IG1vY2tSZXNwb25zZS5qc29uLm1vY2suY2FsbHNbMF1bMF07XHJcbiAgICAgIGV4cGVjdChyZXNwb25zZS5tZXRhLnJlcXVlc3RJZCkudG9CZSgnY29yci00NTYnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbm90IGluY2x1ZGUgcmVxdWVzdElkIGlmIG5laXRoZXIgaGVhZGVyIGlzIHByZXNlbnQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcignVGVzdCBlcnJvcicpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBtb2NrUmVzcG9uc2UuanNvbi5tb2NrLmNhbGxzWzBdWzBdO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2UubWV0YS5yZXF1ZXN0SWQpLnRvQmVVbmRlZmluZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnbm9uLUVycm9yIGV4Y2VwdGlvbiBoYW5kbGluZycsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdkZXZlbG9wbWVudCc7XHJcbiAgICAgIGZpbHRlciA9IG5ldyBBbGxFeGNlcHRpb25zRmlsdGVyKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzdHJpbmcgdGhyb3dzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSAnc3RyaW5nIGVycm9yJztcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrUmVzcG9uc2Uuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCg1MDApO1xyXG4gICAgICBleHBlY3QobW9ja1Jlc3BvbnNlLmpzb24pLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgbG9nIHN0cmluZyB0aHJvd3MgYXBwcm9wcmlhdGVseScsICgpID0+IHtcclxuICAgICAgY29uc3QgbG9nZ2VyRXJyb3JTcHkgPSBqZXN0LnNweU9uKGZpbHRlclsnbG9nZ2VyJ10sICdlcnJvcicpO1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSAnc3RyaW5nIGVycm9yJztcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGV4cGVjdChsb2dnZXJFcnJvclNweSkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgICBjb25zdCBsb2dDYWxsID0gbG9nZ2VyRXJyb3JTcHkubW9jay5jYWxsc1swXTtcclxuICAgICAgZXhwZWN0KGxvZ0NhbGxbMF0pLnRvQ29udGFpbignVW5rbm93biBleGNlcHRpb24gdHlwZScpO1xyXG4gICAgICBleHBlY3QobG9nQ2FsbFsxXSkudG9CZSgnc3RyaW5nIGVycm9yJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2xvZ2dpbmcnLCAoKSA9PiB7XHJcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgICAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSAnZGV2ZWxvcG1lbnQnO1xyXG4gICAgICBmaWx0ZXIgPSBuZXcgQWxsRXhjZXB0aW9uc0ZpbHRlcigpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBhbHdheXMgbG9nIHdpdGggc3RhY2sgdHJhY2UgZm9yIEVycm9yIGluc3RhbmNlcycsICgpID0+IHtcclxuICAgICAgY29uc3QgbG9nZ2VyRXJyb3JTcHkgPSBqZXN0LnNweU9uKGZpbHRlclsnbG9nZ2VyJ10sICdlcnJvcicpO1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3Igd2l0aCBzdGFjaycpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgZXhwZWN0KGxvZ2dlckVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICAgIGNvbnN0IGxvZ0NhbGwgPSBsb2dnZXJFcnJvclNweS5tb2NrLmNhbGxzWzBdO1xyXG4gICAgICBleHBlY3QobG9nQ2FsbFsxXSkudG9CZVRydXRoeSgpOyAvLyBTdGFjayB0cmFjZVxyXG4gICAgICBleHBlY3QobG9nQ2FsbFsyXSkudG9Db250YWluKCdtZXRob2QnKTsgLy8gTG9nIGNvbnRleHRcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSByZXF1ZXN0IG1ldGFkYXRhIGluIGxvZyBjb250ZXh0JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBsb2dnZXJFcnJvclNweSA9IGplc3Quc3B5T24oZmlsdGVyWydsb2dnZXInXSwgJ2Vycm9yJyk7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcignVGVzdCBlcnJvcicpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgY29uc3QgbG9nQ29udGV4dFN0ciA9IGxvZ2dlckVycm9yU3B5Lm1vY2suY2FsbHNbMF1bMl07XHJcbiAgICAgIGNvbnN0IGxvZ0NvbnRleHQgPSBKU09OLnBhcnNlKGxvZ0NvbnRleHRTdHIpO1xyXG5cclxuICAgICAgZXhwZWN0KGxvZ0NvbnRleHQpLnRvTWF0Y2hPYmplY3Qoe1xyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgIHVybDogJy9hcGkvdGVzdCcsXHJcbiAgICAgICAgaXA6ICcxMjcuMC4wLjEnLFxyXG4gICAgICAgIHVzZXJBZ2VudDogJ3Rlc3QtYWdlbnQnLFxyXG4gICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShTdHJpbmcpLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgdHJ1bmNhdGUgbG9uZyB1c2VyIGFnZW50cycsICgpID0+IHtcclxuICAgICAgY29uc3QgbG9nZ2VyRXJyb3JTcHkgPSBqZXN0LnNweU9uKGZpbHRlclsnbG9nZ2VyJ10sICdlcnJvcicpO1xyXG4gICAgICBjb25zdCBsb25nVXNlckFnZW50ID0gJ3gnLnJlcGVhdCgyMDApO1xyXG4gICAgICBtb2NrUmVxdWVzdC5oZWFkZXJzWyd1c2VyLWFnZW50J10gPSBsb25nVXNlckFnZW50O1xyXG5cclxuICAgICAgY29uc3QgZXhjZXB0aW9uID0gbmV3IEVycm9yKCdUZXN0IGVycm9yJyk7XHJcblxyXG4gICAgICBmaWx0ZXIuY2F0Y2goZXhjZXB0aW9uLCBtb2NrQXJndW1lbnRzSG9zdCk7XHJcblxyXG4gICAgICBjb25zdCBsb2dDb250ZXh0U3RyID0gbG9nZ2VyRXJyb3JTcHkubW9jay5jYWxsc1swXVsyXTtcclxuICAgICAgY29uc3QgbG9nQ29udGV4dCA9IEpTT04ucGFyc2UobG9nQ29udGV4dFN0cik7XHJcblxyXG4gICAgICBleHBlY3QobG9nQ29udGV4dC51c2VyQWdlbnQubGVuZ3RoKS50b0JlKDEwMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ3Jlc3BvbnNlIGZvcm1hdCcsICgpID0+IHtcclxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9ICdkZXZlbG9wbWVudCc7XHJcbiAgICAgIGZpbHRlciA9IG5ldyBBbGxFeGNlcHRpb25zRmlsdGVyKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIG5ldmVyIGluY2x1ZGUgc3RhY2sgdHJhY2UgaW4gcmVzcG9uc2UnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcignVGVzdCBlcnJvcicpO1xyXG4gICAgICBleGNlcHRpb24uc3RhY2sgPSAnRXJyb3I6IFRlc3QgZXJyb3JcXG4gICAgYXQgc29tZXRoaW5nLi4uJztcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSkubm90LnRvQ29udGFpbihleGNlcHRpb24uc3RhY2spO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBhbHdheXMgc2V0IHN1Y2Nlc3MgdG8gZmFsc2UnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV4Y2VwdGlvbiA9IG5ldyBFcnJvcignVGVzdCBlcnJvcicpO1xyXG5cclxuICAgICAgZmlsdGVyLmNhdGNoKGV4Y2VwdGlvbiwgbW9ja0FyZ3VtZW50c0hvc3QpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBtb2NrUmVzcG9uc2UuanNvbi5tb2NrLmNhbGxzWzBdWzBdO1xyXG4gICAgICBleHBlY3QocmVzcG9uc2Uuc3VjY2VzcykudG9CZShmYWxzZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgcHJvcGVyIG1ldGFkYXRhJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBleGNlcHRpb24gPSBuZXcgRXJyb3IoJ1Rlc3QgZXJyb3InKTtcclxuXHJcbiAgICAgIGZpbHRlci5jYXRjaChleGNlcHRpb24sIG1vY2tBcmd1bWVudHNIb3N0KTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gbW9ja1Jlc3BvbnNlLmpzb24ubW9jay5jYWxsc1swXVswXTtcclxuICAgICAgZXhwZWN0KHJlc3BvbnNlLm1ldGEpLnRvTWF0Y2hPYmplY3Qoe1xyXG4gICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShTdHJpbmcpLFxyXG4gICAgICAgIHBhdGg6ICcvYXBpL3Rlc3QnLFxyXG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sInZlcnNpb24iOjN9