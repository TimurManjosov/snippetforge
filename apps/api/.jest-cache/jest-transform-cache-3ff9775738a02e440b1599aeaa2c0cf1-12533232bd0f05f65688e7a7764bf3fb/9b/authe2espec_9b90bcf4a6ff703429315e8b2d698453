dc34a5c1c9491cd28b7db70bf526b0c2
"use strict";
/* eslint-disable @typescript-eslint/no-unsafe-argument */
/* eslint-disable @typescript-eslint/no-unsafe-assignment */
/* eslint-disable @typescript-eslint/no-unsafe-member-access */
// test/e2e/auth.e2e-spec.ts
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@nestjs/common");
const testing_1 = require("@nestjs/testing");
const supertest_1 = __importDefault(require("supertest"));
const app_module_1 = require("../../src/app.module");
const filters_1 = require("../../src/shared/filters");
const factories_1 = require("../factories");
/**
 * Auth E2E Tests
 *
 * Testet den vollständigen Auth-Flow:
 * - Registration
 * - Login
 * - Protected Routes
 * - Error Handling
 *
 * HINWEIS: Diese Tests benötigen eine laufende Datenbank!
 * Für CI/CD sollte eine Test-DB verwendet werden.
 */
describe('Auth (E2E)', () => {
    let app;
    beforeAll(async () => {
        const moduleFixture = await testing_1.Test.createTestingModule({
            imports: [app_module_1.AppModule],
        }).compile();
        app = moduleFixture.createNestApplication();
        // Gleiche Konfiguration wie in main.ts
        app.setGlobalPrefix('api');
        app.useGlobalFilters(new filters_1.AllExceptionsFilter(), new filters_1.HttpExceptionFilter());
        await app.init();
    });
    afterAll(async () => {
        await app.close();
    });
    // ============================================================
    // POST /api/auth/register
    // ============================================================
    describe('POST /api/auth/register', () => {
        describe('with valid data', () => {
            it('should register a new user and return tokens', async () => {
                // Arrange
                const dto = (0, factories_1.createRegisterDto)();
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/register')
                    .send(dto);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.CREATED);
                expect(response.body).toHaveProperty('user');
                expect(response.body).toHaveProperty('tokens');
                expect(response.body.user.email).toBe(dto.email);
                expect(response.body.user.username).toBe(dto.username);
                expect(response.body.user).not.toHaveProperty('passwordHash');
                expect(response.body.tokens.accessToken).toBeDefined();
                expect(response.body.tokens.tokenType).toBe('Bearer');
            });
            it('should return user with correct role', async () => {
                // Arrange
                const dto = (0, factories_1.createRegisterDto)();
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/register')
                    .send(dto);
                // Assert
                expect(response.body.user.role).toBe('USER');
            });
        });
        describe('with invalid data', () => {
            it('should return 400 for invalid email', async () => {
                // Arrange
                const dto = factories_1.invalidAuthData.register.invalidEmail;
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/register')
                    .send(dto);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.BAD_REQUEST);
                expect(response.body.success).toBe(false);
                expect(response.body.error.code).toBe('VALIDATION_ERROR');
            });
            it('should return 400 for weak password', async () => {
                // Arrange
                const dto = factories_1.invalidAuthData.register.weakPassword;
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/register')
                    .send(dto);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.BAD_REQUEST);
                expect(response.body.error.details).toBeDefined();
            });
            it('should return 400 for missing fields', async () => {
                // Arrange
                const dto = factories_1.invalidAuthData.register.missingEmail;
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/register')
                    .send(dto);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.BAD_REQUEST);
            });
        });
        describe('with duplicate data', () => {
            it('should return 409 for duplicate email', async () => {
                // Arrange
                const dto = (0, factories_1.createRegisterDto)();
                // First registration
                await (0, supertest_1.default)(app.getHttpServer()).post('/api/auth/register').send(dto);
                // Act - Second registration with same email
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/register')
                    .send({ ...dto, username: 'different_username' });
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.CONFLICT);
                expect(response.body.error.code).toBe('USER_EMAIL_EXISTS');
            });
            it('should return 409 for duplicate username', async () => {
                // Arrange
                const dto = (0, factories_1.createRegisterDto)();
                // First registration
                await (0, supertest_1.default)(app.getHttpServer()).post('/api/auth/register').send(dto);
                // Act - Second registration with same username
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/register')
                    .send({ ...dto, email: 'different@email.com' });
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.CONFLICT);
                expect(response.body.error.code).toBe('USER_USERNAME_EXISTS');
            });
        });
    });
    // ============================================================
    // POST /api/auth/login
    // ============================================================
    describe('POST /api/auth/login', () => {
        let registeredUser;
        beforeAll(async () => {
            // Register a user for login tests
            const dto = (0, factories_1.createRegisterDto)();
            await (0, supertest_1.default)(app.getHttpServer()).post('/api/auth/register').send(dto);
            registeredUser = {
                email: dto.email,
                password: dto.password,
            };
        });
        describe('with valid credentials', () => {
            it('should login and return tokens', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send(registeredUser);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.OK);
                expect(response.body).toHaveProperty('user');
                expect(response.body).toHaveProperty('tokens');
                expect(response.body.tokens.accessToken).toBeDefined();
            });
            it('should return user without passwordHash', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send(registeredUser);
                // Assert
                expect(response.body.user).not.toHaveProperty('passwordHash');
            });
        });
        describe('with invalid credentials', () => {
            it('should return 401 for wrong password', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send({
                    email: registeredUser.email,
                    password: 'WrongPassword123',
                });
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.UNAUTHORIZED);
                expect(response.body.error.code).toBe('AUTH_INVALID_CREDENTIALS');
            });
            it('should return 401 for non-existent email', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send({
                    email: 'nonexistent@email.com',
                    password: 'SomePassword123',
                });
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.UNAUTHORIZED);
                expect(response.body.error.message).toBe('Invalid email or password');
            });
            it('should return same error message for wrong email and wrong password', async () => {
                // Security: Prevent user enumeration
                // Wrong email
                const wrongEmailResponse = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send({ email: 'wrong@email.com', password: 'Pass123!' });
                // Wrong password
                const wrongPasswordResponse = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send({ email: registeredUser.email, password: 'WrongPass123' });
                // Assert - Same message for both
                expect(wrongEmailResponse.body.error.message).toBe(wrongPasswordResponse.body.error.message);
            });
        });
        describe('with invalid data', () => {
            it('should return 400 for invalid email format', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send(factories_1.invalidAuthData.login.invalidEmail);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.BAD_REQUEST);
            });
            it('should return 400 for missing password', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .post('/api/auth/login')
                    .send(factories_1.invalidAuthData.login.missingPassword);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.BAD_REQUEST);
            });
        });
    });
    // ============================================================
    // GET /api/auth/me
    // ============================================================
    describe('GET /api/auth/me', () => {
        let accessToken;
        let userEmail;
        beforeAll(async () => {
            // Register and get token
            const dto = (0, factories_1.createRegisterDto)();
            const response = await (0, supertest_1.default)(app.getHttpServer())
                .post('/api/auth/register')
                .send(dto);
            accessToken = response.body.tokens.accessToken;
            userEmail = dto.email;
        });
        describe('with valid token', () => {
            it('should return current user profile', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .get('/api/auth/me')
                    .set('Authorization', `Bearer ${accessToken}`);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.OK);
                expect(response.body.email).toBe(userEmail);
                expect(response.body).not.toHaveProperty('passwordHash');
            });
            it('should return user with all expected fields', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .get('/api/auth/me')
                    .set('Authorization', `Bearer ${accessToken}`);
                // Assert
                expect(response.body).toHaveProperty('id');
                expect(response.body).toHaveProperty('email');
                expect(response.body).toHaveProperty('username');
                expect(response.body).toHaveProperty('bio');
                expect(response.body).toHaveProperty('avatarUrl');
                expect(response.body).toHaveProperty('role');
                expect(response.body).toHaveProperty('createdAt');
                expect(response.body).toHaveProperty('updatedAt');
            });
        });
        describe('without token', () => {
            it('should return 401', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer()).get('/api/auth/me');
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.UNAUTHORIZED);
                expect(response.body.error.code).toBe('AUTH_TOKEN_INVALID');
            });
        });
        describe('with invalid token', () => {
            it('should return 401 for malformed token', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .get('/api/auth/me')
                    .set('Authorization', 'Bearer invalid-token');
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.UNAUTHORIZED);
            });
            it('should return 401 for expired token', async () => {
                // Arrange - Create an expired token (this is a simplified example)
                const expiredToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwiZXhwIjoxfQ.invalid';
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .get('/api/auth/me')
                    .set('Authorization', `Bearer ${expiredToken}`);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.UNAUTHORIZED);
            });
            it('should return 401 for wrong authorization scheme', async () => {
                // Act
                const response = await (0, supertest_1.default)(app.getHttpServer())
                    .get('/api/auth/me')
                    .set('Authorization', `Basic ${accessToken}`);
                // Assert
                expect(response.status).toBe(common_1.HttpStatus.UNAUTHORIZED);
            });
        });
    });
    // ============================================================
    // FULL AUTH FLOW
    // ============================================================
    describe('Full Auth Flow', () => {
        it('should complete register -> login -> me flow', async () => {
            // 1. Register
            const registerDto = (0, factories_1.createRegisterDto)();
            const registerResponse = await (0, supertest_1.default)(app.getHttpServer())
                .post('/api/auth/register')
                .send(registerDto);
            expect(registerResponse.status).toBe(common_1.HttpStatus.CREATED);
            // 2. Login
            const loginResponse = await (0, supertest_1.default)(app.getHttpServer())
                .post('/api/auth/login')
                .send({
                email: registerDto.email,
                password: registerDto.password,
            });
            expect(loginResponse.status).toBe(common_1.HttpStatus.OK);
            const token = loginResponse.body.tokens.accessToken;
            // 3. Get Profile
            const meResponse = await (0, supertest_1.default)(app.getHttpServer())
                .get('/api/auth/me')
                .set('Authorization', `Bearer ${token}`);
            expect(meResponse.status).toBe(common_1.HttpStatus.OK);
            expect(meResponse.body.email).toBe(registerDto.email);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aW11clxcUHJvZ3JhbW1pbmdcXFByb2plY3RzXFxzbmlwcGV0Zm9yZ2VcXGFwcHNcXGFwaVxcdGVzdFxcZTJlXFxhdXRoLmUyZS1zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQSwwREFBMEQ7QUFDMUQsNERBQTREO0FBQzVELCtEQUErRDtBQUMvRCw0QkFBNEI7Ozs7O0FBRTVCLDJDQUE4RDtBQUM5RCw2Q0FBc0Q7QUFDdEQsMERBQWdDO0FBQ2hDLHFEQUFpRDtBQUNqRCxzREFHa0M7QUFDbEMsNENBQWtFO0FBRWxFOzs7Ozs7Ozs7OztHQVdHO0FBQ0gsUUFBUSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7SUFDMUIsSUFBSSxHQUFxQixDQUFDO0lBRTFCLFNBQVMsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNuQixNQUFNLGFBQWEsR0FBa0IsTUFBTSxjQUFJLENBQUMsbUJBQW1CLENBQUM7WUFDbEUsT0FBTyxFQUFFLENBQUMsc0JBQVMsQ0FBQztTQUNyQixDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFYixHQUFHLEdBQUcsYUFBYSxDQUFDLHFCQUFxQixFQUFFLENBQUM7UUFFNUMsdUNBQXVDO1FBQ3ZDLEdBQUcsQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0IsR0FBRyxDQUFDLGdCQUFnQixDQUFDLElBQUksNkJBQW1CLEVBQUUsRUFBRSxJQUFJLDZCQUFtQixFQUFFLENBQUMsQ0FBQztRQUUzRSxNQUFNLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNuQixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxLQUFLLElBQUksRUFBRTtRQUNsQixNQUFNLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUNwQixDQUFDLENBQUMsQ0FBQztJQUVILCtEQUErRDtJQUMvRCwwQkFBMEI7SUFDMUIsK0RBQStEO0lBRS9ELFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxHQUFHLEVBQUU7UUFDdkMsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFB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QUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGltdXJcXFByb2dyYW1taW5nXFxQcm9qZWN0c1xcc25pcHBldGZvcmdlXFxhcHBzXFxhcGlcXHRlc3RcXGUyZVxcYXV0aC5lMmUtc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFyZ3VtZW50ICovXHJcbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtYXNzaWdubWVudCAqL1xyXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3MgKi9cclxuLy8gdGVzdC9lMmUvYXV0aC5lMmUtc3BlYy50c1xyXG5cclxuaW1wb3J0IHsgSHR0cFN0YXR1cywgSU5lc3RBcHBsaWNhdGlvbiB9IGZyb20gJ0BuZXN0anMvY29tbW9uJztcclxuaW1wb3J0IHsgVGVzdCwgVGVzdGluZ01vZHVsZSB9IGZyb20gJ0BuZXN0anMvdGVzdGluZyc7XHJcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XHJcbmltcG9ydCB7IEFwcE1vZHVsZSB9IGZyb20gJy4uLy4uL3NyYy9hcHAubW9kdWxlJztcclxuaW1wb3J0IHtcclxuICBBbGxFeGNlcHRpb25zRmlsdGVyLFxyXG4gIEh0dHBFeGNlcHRpb25GaWx0ZXIsXHJcbn0gZnJvbSAnLi4vLi4vc3JjL3NoYXJlZC9maWx0ZXJzJztcclxuaW1wb3J0IHsgY3JlYXRlUmVnaXN0ZXJEdG8sIGludmFsaWRBdXRoRGF0YSB9IGZyb20gJy4uL2ZhY3Rvcmllcyc7XHJcblxyXG4vKipcclxuICogQXV0aCBFMkUgVGVzdHNcclxuICpcclxuICogVGVzdGV0IGRlbiB2b2xsc3TDpG5kaWdlbiBBdXRoLUZsb3c6XHJcbiAqIC0gUmVnaXN0cmF0aW9uXHJcbiAqIC0gTG9naW5cclxuICogLSBQcm90ZWN0ZWQgUm91dGVzXHJcbiAqIC0gRXJyb3IgSGFuZGxpbmdcclxuICpcclxuICogSElOV0VJUzogRGllc2UgVGVzdHMgYmVuw7Z0aWdlbiBlaW5lIGxhdWZlbmRlIERhdGVuYmFuayFcclxuICogRsO8ciBDSS9DRCBzb2xsdGUgZWluZSBUZXN0LURCIHZlcndlbmRldCB3ZXJkZW4uXHJcbiAqL1xyXG5kZXNjcmliZSgnQXV0aCAoRTJFKScsICgpID0+IHtcclxuICBsZXQgYXBwOiBJTmVzdEFwcGxpY2F0aW9uO1xyXG5cclxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgbW9kdWxlRml4dHVyZTogVGVzdGluZ01vZHVsZSA9IGF3YWl0IFRlc3QuY3JlYXRlVGVzdGluZ01vZHVsZSh7XHJcbiAgICAgIGltcG9ydHM6IFtBcHBNb2R1bGVdLFxyXG4gICAgfSkuY29tcGlsZSgpO1xyXG5cclxuICAgIGFwcCA9IG1vZHVsZUZpeHR1cmUuY3JlYXRlTmVzdEFwcGxpY2F0aW9uKCk7XHJcblxyXG4gICAgLy8gR2xlaWNoZSBLb25maWd1cmF0aW9uIHdpZSBpbiBtYWluLnRzXHJcbiAgICBhcHAuc2V0R2xvYmFsUHJlZml4KCdhcGknKTtcclxuICAgIGFwcC51c2VHbG9iYWxGaWx0ZXJzKG5ldyBBbGxFeGNlcHRpb25zRmlsdGVyKCksIG5ldyBIdHRwRXhjZXB0aW9uRmlsdGVyKCkpO1xyXG5cclxuICAgIGF3YWl0IGFwcC5pbml0KCk7XHJcbiAgfSk7XHJcblxyXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcclxuICAgIGF3YWl0IGFwcC5jbG9zZSgpO1xyXG4gIH0pO1xyXG5cclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBQT1NUIC9hcGkvYXV0aC9yZWdpc3RlclxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuICBkZXNjcmliZSgnUE9TVCAvYXBpL2F1dGgvcmVnaXN0ZXInLCAoKSA9PiB7XHJcbiAgICBkZXNjcmliZSgnd2l0aCB2YWxpZCBkYXRhJywgKCkgPT4ge1xyXG4gICAgICBpdCgnc2hvdWxkIHJlZ2lzdGVyIGEgbmV3IHVzZXIgYW5kIHJldHVybiB0b2tlbnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQXJyYW5nZVxyXG4gICAgICAgIGNvbnN0IGR0byA9IGNyZWF0ZVJlZ2lzdGVyRHRvKCk7XHJcblxyXG4gICAgICAgIC8vIEFjdFxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9yZWdpc3RlcicpXHJcbiAgICAgICAgICAuc2VuZChkdG8pO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuQ1JFQVRFRCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCd1c2VyJyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCd0b2tlbnMnKTtcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS51c2VyLmVtYWlsKS50b0JlKGR0by5lbWFpbCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkudXNlci51c2VybmFtZSkudG9CZShkdG8udXNlcm5hbWUpO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnVzZXIpLm5vdC50b0hhdmVQcm9wZXJ0eSgncGFzc3dvcmRIYXNoJyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkudG9rZW5zLmFjY2Vzc1Rva2VuKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LnRva2Vucy50b2tlblR5cGUpLnRvQmUoJ0JlYXJlcicpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVzZXIgd2l0aCBjb3JyZWN0IHJvbGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQXJyYW5nZVxyXG4gICAgICAgIGNvbnN0IGR0byA9IGNyZWF0ZVJlZ2lzdGVyRHRvKCk7XHJcblxyXG4gICAgICAgIC8vIEFjdFxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9yZWdpc3RlcicpXHJcbiAgICAgICAgICAuc2VuZChkdG8pO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS51c2VyLnJvbGUpLnRvQmUoJ1VTRVInKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnd2l0aCBpbnZhbGlkIGRhdGEnLCAoKSA9PiB7XHJcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBmb3IgaW52YWxpZCBlbWFpbCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAvLyBBcnJhbmdlXHJcbiAgICAgICAgY29uc3QgZHRvID0gaW52YWxpZEF1dGhEYXRhLnJlZ2lzdGVyLmludmFsaWRFbWFpbDtcclxuXHJcbiAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXHJcbiAgICAgICAgICAucG9zdCgnL2FwaS9hdXRoL3JlZ2lzdGVyJylcclxuICAgICAgICAgIC5zZW5kKGR0byk7XHJcblxyXG4gICAgICAgIC8vIEFzc2VydFxyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoSHR0cFN0YXR1cy5CQURfUkVRVUVTVCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuc3VjY2VzcykudG9CZShmYWxzZSk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IuY29kZSkudG9CZSgnVkFMSURBVElPTl9FUlJPUicpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBmb3Igd2VhayBwYXNzd29yZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAvLyBBcnJhbmdlXHJcbiAgICAgICAgY29uc3QgZHRvID0gaW52YWxpZEF1dGhEYXRhLnJlZ2lzdGVyLndlYWtQYXNzd29yZDtcclxuXHJcbiAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXHJcbiAgICAgICAgICAucG9zdCgnL2FwaS9hdXRoL3JlZ2lzdGVyJylcclxuICAgICAgICAgIC5zZW5kKGR0byk7XHJcblxyXG4gICAgICAgIC8vIEFzc2VydFxyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoSHR0cFN0YXR1cy5CQURfUkVRVUVTVCk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IuZGV0YWlscykudG9CZURlZmluZWQoKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgZm9yIG1pc3NpbmcgZmllbGRzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIC8vIEFycmFuZ2VcclxuICAgICAgICBjb25zdCBkdG8gPSBpbnZhbGlkQXV0aERhdGEucmVnaXN0ZXIubWlzc2luZ0VtYWlsO1xyXG5cclxuICAgICAgICAvLyBBY3RcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvcmVnaXN0ZXInKVxyXG4gICAgICAgICAgLnNlbmQoZHRvKTtcclxuXHJcbiAgICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZShIdHRwU3RhdHVzLkJBRF9SRVFVRVNUKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnd2l0aCBkdXBsaWNhdGUgZGF0YScsICgpID0+IHtcclxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA5IGZvciBkdXBsaWNhdGUgZW1haWwnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQXJyYW5nZVxyXG4gICAgICAgIGNvbnN0IGR0byA9IGNyZWF0ZVJlZ2lzdGVyRHRvKCk7XHJcblxyXG4gICAgICAgIC8vIEZpcnN0IHJlZ2lzdHJhdGlvblxyXG4gICAgICAgIGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSkucG9zdCgnL2FwaS9hdXRoL3JlZ2lzdGVyJykuc2VuZChkdG8pO1xyXG5cclxuICAgICAgICAvLyBBY3QgLSBTZWNvbmQgcmVnaXN0cmF0aW9uIHdpdGggc2FtZSBlbWFpbFxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9yZWdpc3RlcicpXHJcbiAgICAgICAgICAuc2VuZCh7IC4uLmR0bywgdXNlcm5hbWU6ICdkaWZmZXJlbnRfdXNlcm5hbWUnIH0pO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuQ09ORkxJQ1QpO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmVycm9yLmNvZGUpLnRvQmUoJ1VTRVJfRU1BSUxfRVhJU1RTJyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDA5IGZvciBkdXBsaWNhdGUgdXNlcm5hbWUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQXJyYW5nZVxyXG4gICAgICAgIGNvbnN0IGR0byA9IGNyZWF0ZVJlZ2lzdGVyRHRvKCk7XHJcblxyXG4gICAgICAgIC8vIEZpcnN0IHJlZ2lzdHJhdGlvblxyXG4gICAgICAgIGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSkucG9zdCgnL2FwaS9hdXRoL3JlZ2lzdGVyJykuc2VuZChkdG8pO1xyXG5cclxuICAgICAgICAvLyBBY3QgLSBTZWNvbmQgcmVnaXN0cmF0aW9uIHdpdGggc2FtZSB1c2VybmFtZVxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9yZWdpc3RlcicpXHJcbiAgICAgICAgICAuc2VuZCh7IC4uLmR0bywgZW1haWw6ICdkaWZmZXJlbnRAZW1haWwuY29tJyB9KTtcclxuXHJcbiAgICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZShIdHRwU3RhdHVzLkNPTkZMSUNUKTtcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvci5jb2RlKS50b0JlKCdVU0VSX1VTRVJOQU1FX0VYSVNUUycpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBQT1NUIC9hcGkvYXV0aC9sb2dpblxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuICBkZXNjcmliZSgnUE9TVCAvYXBpL2F1dGgvbG9naW4nLCAoKSA9PiB7XHJcbiAgICBsZXQgcmVnaXN0ZXJlZFVzZXI6IHsgZW1haWw6IHN0cmluZzsgcGFzc3dvcmQ6IHN0cmluZyB9O1xyXG5cclxuICAgIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XHJcbiAgICAgIC8vIFJlZ2lzdGVyIGEgdXNlciBmb3IgbG9naW4gdGVzdHNcclxuICAgICAgY29uc3QgZHRvID0gY3JlYXRlUmVnaXN0ZXJEdG8oKTtcclxuICAgICAgYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKS5wb3N0KCcvYXBpL2F1dGgvcmVnaXN0ZXInKS5zZW5kKGR0byk7XHJcblxyXG4gICAgICByZWdpc3RlcmVkVXNlciA9IHtcclxuICAgICAgICBlbWFpbDogZHRvLmVtYWlsLFxyXG4gICAgICAgIHBhc3N3b3JkOiBkdG8ucGFzc3dvcmQsXHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnd2l0aCB2YWxpZCBjcmVkZW50aWFscycsICgpID0+IHtcclxuICAgICAgaXQoJ3Nob3VsZCBsb2dpbiBhbmQgcmV0dXJuIHRva2VucycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAvLyBBY3RcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9naW4nKVxyXG4gICAgICAgICAgLnNlbmQocmVnaXN0ZXJlZFVzZXIpO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuT0spO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgndXNlcicpO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgndG9rZW5zJyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkudG9rZW5zLmFjY2Vzc1Rva2VuKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVzZXIgd2l0aG91dCBwYXNzd29yZEhhc2gnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXHJcbiAgICAgICAgICAucG9zdCgnL2FwaS9hdXRoL2xvZ2luJylcclxuICAgICAgICAgIC5zZW5kKHJlZ2lzdGVyZWRVc2VyKTtcclxuXHJcbiAgICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkudXNlcikubm90LnRvSGF2ZVByb3BlcnR5KCdwYXNzd29yZEhhc2gnKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnd2l0aCBpbnZhbGlkIGNyZWRlbnRpYWxzJywgKCkgPT4ge1xyXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgZm9yIHdyb25nIHBhc3N3b3JkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIC8vIEFjdFxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXHJcbiAgICAgICAgICAuc2VuZCh7XHJcbiAgICAgICAgICAgIGVtYWlsOiByZWdpc3RlcmVkVXNlci5lbWFpbCxcclxuICAgICAgICAgICAgcGFzc3dvcmQ6ICdXcm9uZ1Bhc3N3b3JkMTIzJyxcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuVU5BVVRIT1JJWkVEKTtcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvci5jb2RlKS50b0JlKCdBVVRIX0lOVkFMSURfQ1JFREVOVElBTFMnKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEgZm9yIG5vbi1leGlzdGVudCBlbWFpbCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAvLyBBY3RcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9naW4nKVxyXG4gICAgICAgICAgLnNlbmQoe1xyXG4gICAgICAgICAgICBlbWFpbDogJ25vbmV4aXN0ZW50QGVtYWlsLmNvbScsXHJcbiAgICAgICAgICAgIHBhc3N3b3JkOiAnU29tZVBhc3N3b3JkMTIzJyxcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuVU5BVVRIT1JJWkVEKTtcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvci5tZXNzYWdlKS50b0JlKCdJbnZhbGlkIGVtYWlsIG9yIHBhc3N3b3JkJyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gc2FtZSBlcnJvciBtZXNzYWdlIGZvciB3cm9uZyBlbWFpbCBhbmQgd3JvbmcgcGFzc3dvcmQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gU2VjdXJpdHk6IFByZXZlbnQgdXNlciBlbnVtZXJhdGlvblxyXG5cclxuICAgICAgICAvLyBXcm9uZyBlbWFpbFxyXG4gICAgICAgIGNvbnN0IHdyb25nRW1haWxSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9naW4nKVxyXG4gICAgICAgICAgLnNlbmQoeyBlbWFpbDogJ3dyb25nQGVtYWlsLmNvbScsIHBhc3N3b3JkOiAnUGFzczEyMyEnIH0pO1xyXG5cclxuICAgICAgICAvLyBXcm9uZyBwYXNzd29yZFxyXG4gICAgICAgIGNvbnN0IHdyb25nUGFzc3dvcmRSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9naW4nKVxyXG4gICAgICAgICAgLnNlbmQoeyBlbWFpbDogcmVnaXN0ZXJlZFVzZXIuZW1haWwsIHBhc3N3b3JkOiAnV3JvbmdQYXNzMTIzJyB9KTtcclxuXHJcbiAgICAgICAgLy8gQXNzZXJ0IC0gU2FtZSBtZXNzYWdlIGZvciBib3RoXHJcbiAgICAgICAgZXhwZWN0KHdyb25nRW1haWxSZXNwb25zZS5ib2R5LmVycm9yLm1lc3NhZ2UpLnRvQmUoXHJcbiAgICAgICAgICB3cm9uZ1Bhc3N3b3JkUmVzcG9uc2UuYm9keS5lcnJvci5tZXNzYWdlLFxyXG4gICAgICAgICk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3dpdGggaW52YWxpZCBkYXRhJywgKCkgPT4ge1xyXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgZm9yIGludmFsaWQgZW1haWwgZm9ybWF0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIC8vIEFjdFxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9sb2dpbicpXHJcbiAgICAgICAgICAuc2VuZChpbnZhbGlkQXV0aERhdGEubG9naW4uaW52YWxpZEVtYWlsKTtcclxuXHJcbiAgICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZShIdHRwU3RhdHVzLkJBRF9SRVFVRVNUKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgZm9yIG1pc3NpbmcgcGFzc3dvcmQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXHJcbiAgICAgICAgICAucG9zdCgnL2FwaS9hdXRoL2xvZ2luJylcclxuICAgICAgICAgIC5zZW5kKGludmFsaWRBdXRoRGF0YS5sb2dpbi5taXNzaW5nUGFzc3dvcmQpO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuQkFEX1JFUVVFU1QpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBHRVQgL2FwaS9hdXRoL21lXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4gIGRlc2NyaWJlKCdHRVQgL2FwaS9hdXRoL21lJywgKCkgPT4ge1xyXG4gICAgbGV0IGFjY2Vzc1Rva2VuOiBzdHJpbmc7XHJcbiAgICBsZXQgdXNlckVtYWlsOiBzdHJpbmc7XHJcblxyXG4gICAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcclxuICAgICAgLy8gUmVnaXN0ZXIgYW5kIGdldCB0b2tlblxyXG4gICAgICBjb25zdCBkdG8gPSBjcmVhdGVSZWdpc3RlckR0bygpO1xyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAucG9zdCgnL2FwaS9hdXRoL3JlZ2lzdGVyJylcclxuICAgICAgICAuc2VuZChkdG8pO1xyXG5cclxuICAgICAgYWNjZXNzVG9rZW4gPSByZXNwb25zZS5ib2R5LnRva2Vucy5hY2Nlc3NUb2tlbjtcclxuICAgICAgdXNlckVtYWlsID0gZHRvLmVtYWlsO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ3dpdGggdmFsaWQgdG9rZW4nLCAoKSA9PiB7XHJcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGN1cnJlbnQgdXNlciBwcm9maWxlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIC8vIEFjdFxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLmdldCgnL2FwaS9hdXRoL21lJylcclxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7YWNjZXNzVG9rZW59YCk7XHJcblxyXG4gICAgICAgIC8vIEFzc2VydFxyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoSHR0cFN0YXR1cy5PSyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZW1haWwpLnRvQmUodXNlckVtYWlsKTtcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkubm90LnRvSGF2ZVByb3BlcnR5KCdwYXNzd29yZEhhc2gnKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiB1c2VyIHdpdGggYWxsIGV4cGVjdGVkIGZpZWxkcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAvLyBBY3RcclxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAgIC5nZXQoJy9hcGkvYXV0aC9tZScpXHJcbiAgICAgICAgICAuc2V0KCdBdXRob3JpemF0aW9uJywgYEJlYXJlciAke2FjY2Vzc1Rva2VufWApO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2lkJyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdlbWFpbCcpO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgndXNlcm5hbWUnKTtcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ2JpbycpO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5KS50b0hhdmVQcm9wZXJ0eSgnYXZhdGFyVXJsJyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdyb2xlJyk7XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvSGF2ZVByb3BlcnR5KCdjcmVhdGVkQXQnKTtcclxuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keSkudG9IYXZlUHJvcGVydHkoJ3VwZGF0ZWRBdCcpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCd3aXRob3V0IHRva2VuJywgKCkgPT4ge1xyXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiA0MDEnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpLmdldCgnL2FwaS9hdXRoL21lJyk7XHJcblxyXG4gICAgICAgIC8vIEFzc2VydFxyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoSHR0cFN0YXR1cy5VTkFVVEhPUklaRUQpO1xyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5ib2R5LmVycm9yLmNvZGUpLnRvQmUoJ0FVVEhfVE9LRU5fSU5WQUxJRCcpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCd3aXRoIGludmFsaWQgdG9rZW4nLCAoKSA9PiB7XHJcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBmb3IgbWFsZm9ybWVkIHRva2VuJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIC8vIEFjdFxyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgICAgLmdldCgnL2FwaS9hdXRoL21lJylcclxuICAgICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCAnQmVhcmVyIGludmFsaWQtdG9rZW4nKTtcclxuXHJcbiAgICAgICAgLy8gQXNzZXJ0XHJcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZShIdHRwU3RhdHVzLlVOQVVUSE9SSVpFRCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gNDAxIGZvciBleHBpcmVkIHRva2VuJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIC8vIEFycmFuZ2UgLSBDcmVhdGUgYW4gZXhwaXJlZCB0b2tlbiAodGhpcyBpcyBhIHNpbXBsaWZpZWQgZXhhbXBsZSlcclxuICAgICAgICBjb25zdCBleHBpcmVkVG9rZW4gPVxyXG4gICAgICAgICAgJ2V5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUp6ZFdJaU9pSXhNak0wTlRZM09Ea3dJaXdpWlhod0lqb3hmUS5pbnZhbGlkJztcclxuXHJcbiAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXHJcbiAgICAgICAgICAuZ2V0KCcvYXBpL2F1dGgvbWUnKVxyXG4gICAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCZWFyZXIgJHtleHBpcmVkVG9rZW59YCk7XHJcblxyXG4gICAgICAgIC8vIEFzc2VydFxyXG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMpLnRvQmUoSHR0cFN0YXR1cy5VTkFVVEhPUklaRUQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMSBmb3Igd3JvbmcgYXV0aG9yaXphdGlvbiBzY2hlbWUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXHJcbiAgICAgICAgICAuZ2V0KCcvYXBpL2F1dGgvbWUnKVxyXG4gICAgICAgICAgLnNldCgnQXV0aG9yaXphdGlvbicsIGBCYXNpYyAke2FjY2Vzc1Rva2VufWApO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuVU5BVVRIT1JJWkVEKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgLy8gRlVMTCBBVVRIIEZMT1dcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbiAgZGVzY3JpYmUoJ0Z1bGwgQXV0aCBGbG93JywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBjb21wbGV0ZSByZWdpc3RlciAtPiBsb2dpbiAtPiBtZSBmbG93JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAvLyAxLiBSZWdpc3RlclxyXG4gICAgICBjb25zdCByZWdpc3RlckR0byA9IGNyZWF0ZVJlZ2lzdGVyRHRvKCk7XHJcbiAgICAgIGNvbnN0IHJlZ2lzdGVyUmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0KGFwcC5nZXRIdHRwU2VydmVyKCkpXHJcbiAgICAgICAgLnBvc3QoJy9hcGkvYXV0aC9yZWdpc3RlcicpXHJcbiAgICAgICAgLnNlbmQocmVnaXN0ZXJEdG8pO1xyXG5cclxuICAgICAgZXhwZWN0KHJlZ2lzdGVyUmVzcG9uc2Uuc3RhdHVzKS50b0JlKEh0dHBTdGF0dXMuQ1JFQVRFRCk7XHJcblxyXG4gICAgICAvLyAyLiBMb2dpblxyXG4gICAgICBjb25zdCBsb2dpblJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdChhcHAuZ2V0SHR0cFNlcnZlcigpKVxyXG4gICAgICAgIC5wb3N0KCcvYXBpL2F1dGgvbG9naW4nKVxyXG4gICAgICAgIC5zZW5kKHtcclxuICAgICAgICAgIGVtYWlsOiByZWdpc3RlckR0by5lbWFpbCxcclxuICAgICAgICAgIHBhc3N3b3JkOiByZWdpc3RlckR0by5wYXNzd29yZCxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIGV4cGVjdChsb2dpblJlc3BvbnNlLnN0YXR1cykudG9CZShIdHRwU3RhdHVzLk9LKTtcclxuICAgICAgY29uc3QgdG9rZW4gPSBsb2dpblJlc3BvbnNlLmJvZHkudG9rZW5zLmFjY2Vzc1Rva2VuO1xyXG5cclxuICAgICAgLy8gMy4gR2V0IFByb2ZpbGVcclxuICAgICAgY29uc3QgbWVSZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QoYXBwLmdldEh0dHBTZXJ2ZXIoKSlcclxuICAgICAgICAuZ2V0KCcvYXBpL2F1dGgvbWUnKVxyXG4gICAgICAgIC5zZXQoJ0F1dGhvcml6YXRpb24nLCBgQmVhcmVyICR7dG9rZW59YCk7XHJcblxyXG4gICAgICBleHBlY3QobWVSZXNwb25zZS5zdGF0dXMpLnRvQmUoSHR0cFN0YXR1cy5PSyk7XHJcbiAgICAgIGV4cGVjdChtZVJlc3BvbnNlLmJvZHkuZW1haWwpLnRvQmUocmVnaXN0ZXJEdG8uZW1haWwpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=