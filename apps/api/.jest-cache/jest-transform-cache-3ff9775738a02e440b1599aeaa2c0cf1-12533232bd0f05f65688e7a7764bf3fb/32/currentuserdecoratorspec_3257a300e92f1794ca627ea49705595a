fc7f94d54e07b9c0b28f6ca72367c657
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const current_user_decorator_1 = require("../../../src/modules/auth/decorators/current-user.decorator");
const test_utils_1 = require("../../setup/test-utils");
describe('CurrentUser decorator', () => {
    it('returns undefined when no user is present', () => {
        const ctx = (0, test_utils_1.createMockExecutionContext)();
        const result = (0, current_user_decorator_1.CurrentUser)(undefined, ctx);
        expect(result).toBeUndefined();
    });
    it('returns full user when no property is requested', () => {
        const user = {
            id: 'user-1',
            email: 'user@example.com',
            username: 'tester',
        };
        const ctx = (0, test_utils_1.createMockExecutionContext)({ request: { user } });
        const result = (0, current_user_decorator_1.CurrentUser)(undefined, ctx);
        expect(result).toEqual(user);
    });
    it('returns a single property when key is provided', () => {
        const user = {
            id: 'user-2',
            email: 'user2@example.com',
            username: 'tester2',
        };
        const ctx = (0, test_utils_1.createMockExecutionContext)({ request: { user } });
        const result = (0, current_user_decorator_1.CurrentUser)('email', ctx);
        expect(result).toBe(user.email);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aW11clxcUHJvZ3JhbW1pbmdcXFByb2plY3RzXFxzbmlwcGV0Zm9yZ2VcXGFwcHNcXGFwaVxcdGVzdFxcdW5pdFxcZGVjb3JhdG9yc1xcY3VycmVudC11c2VyLmRlY29yYXRvci5zcGVjLnRzIiwibWFwcGluZ3MiOiI7O0FBQ0Esd0dBQTBGO0FBQzFGLHVEQUFvRTtBQUVwRSxRQUFRLENBQUMsdUJBQXVCLEVBQUUsR0FBRyxFQUFFO0lBQ3JDLEVBQUUsQ0FBQywyQ0FBMkMsRUFBRSxHQUFHLEVBQUU7UUFDbkQsTUFBTSxHQUFHLEdBQUcsSUFBQSx1Q0FBMEIsR0FBRSxDQUFDO1FBRXpDLE1BQU0sTUFBTSxHQUFHLElBQUEsb0NBQVcsRUFBQyxTQUFTLEVBQUUsR0FBa0MsQ0FBQyxDQUFDO1FBRTFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUNqQyxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxHQUFHLEVBQUU7UUFDekQsTUFBTSxJQUFJLEdBQUc7WUFDWCxFQUFFLEVBQUUsUUFBUTtZQUNaLEtBQUssRUFBRSxrQkFBa0I7WUFDekIsUUFBUSxFQUFFLFFBQVE7U0FDbkIsQ0FBQztRQUNGLE1BQU0sR0FBRyxHQUFHLElBQUEsdUNBQTBCLEVBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFOUQsTUFBTSxNQUFNLEdBQUcsSUFBQSxvQ0FBVyxFQUFDLFNBQVMsRUFBRSxHQUFrQyxDQUFDLENBQUM7UUFFMUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMvQixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7UUFDeEQsTUFBTSxJQUFJLEdBQUc7WUFDWCxFQUFFLEVBQUUsUUFBUTtZQUNaLEtBQUssRUFBRSxtQkFBbUI7WUFDMUIsUUFBUSxFQUFFLFNBQVM7U0FDcEIsQ0FBQztRQUNGLE1BQU0sR0FBRyxHQUFHLElBQUEsdUNBQTBCLEVBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFOUQsTUFBTSxNQUFNLEdBQUcsSUFBQSxvQ0FBVyxFQUFDLE9BQU8sRUFBRSxHQUFrQyxDQUFDLENBQUM7UUFFeEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDbEMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXHRpbXVyXFxQcm9ncmFtbWluZ1xcUHJvamVjdHNcXHNuaXBwZXRmb3JnZVxcYXBwc1xcYXBpXFx0ZXN0XFx1bml0XFxkZWNvcmF0b3JzXFxjdXJyZW50LXVzZXIuZGVjb3JhdG9yLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBFeGVjdXRpb25Db250ZXh0IH0gZnJvbSAnQG5lc3Rqcy9jb21tb24nO1xyXG5pbXBvcnQgeyBDdXJyZW50VXNlciB9IGZyb20gJy4uLy4uLy4uL3NyYy9tb2R1bGVzL2F1dGgvZGVjb3JhdG9ycy9jdXJyZW50LXVzZXIuZGVjb3JhdG9yJztcclxuaW1wb3J0IHsgY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQgfSBmcm9tICcuLi8uLi9zZXR1cC90ZXN0LXV0aWxzJztcclxuXHJcbmRlc2NyaWJlKCdDdXJyZW50VXNlciBkZWNvcmF0b3InLCAoKSA9PiB7XHJcbiAgaXQoJ3JldHVybnMgdW5kZWZpbmVkIHdoZW4gbm8gdXNlciBpcyBwcmVzZW50JywgKCkgPT4ge1xyXG4gICAgY29uc3QgY3R4ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQoKTtcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBDdXJyZW50VXNlcih1bmRlZmluZWQsIGN0eCBhcyB1bmtub3duIGFzIEV4ZWN1dGlvbkNvbnRleHQpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQpLnRvQmVVbmRlZmluZWQoKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ3JldHVybnMgZnVsbCB1c2VyIHdoZW4gbm8gcHJvcGVydHkgaXMgcmVxdWVzdGVkJywgKCkgPT4ge1xyXG4gICAgY29uc3QgdXNlciA9IHtcclxuICAgICAgaWQ6ICd1c2VyLTEnLFxyXG4gICAgICBlbWFpbDogJ3VzZXJAZXhhbXBsZS5jb20nLFxyXG4gICAgICB1c2VybmFtZTogJ3Rlc3RlcicsXHJcbiAgICB9O1xyXG4gICAgY29uc3QgY3R4ID0gY3JlYXRlTW9ja0V4ZWN1dGlvbkNvbnRleHQoeyByZXF1ZXN0OiB7IHVzZXIgfSB9KTtcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBDdXJyZW50VXNlcih1bmRlZmluZWQsIGN0eCBhcyB1bmtub3duIGFzIEV4ZWN1dGlvbkNvbnRleHQpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwodXNlcik7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdyZXR1cm5zIGEgc2luZ2xlIHByb3BlcnR5IHdoZW4ga2V5IGlzIHByb3ZpZGVkJywgKCkgPT4ge1xyXG4gICAgY29uc3QgdXNlciA9IHtcclxuICAgICAgaWQ6ICd1c2VyLTInLFxyXG4gICAgICBlbWFpbDogJ3VzZXIyQGV4YW1wbGUuY29tJyxcclxuICAgICAgdXNlcm5hbWU6ICd0ZXN0ZXIyJyxcclxuICAgIH07XHJcbiAgICBjb25zdCBjdHggPSBjcmVhdGVNb2NrRXhlY3V0aW9uQ29udGV4dCh7IHJlcXVlc3Q6IHsgdXNlciB9IH0pO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IEN1cnJlbnRVc2VyKCdlbWFpbCcsIGN0eCBhcyB1bmtub3duIGFzIEV4ZWN1dGlvbkNvbnRleHQpO1xyXG5cclxuICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodXNlci5lbWFpbCk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=