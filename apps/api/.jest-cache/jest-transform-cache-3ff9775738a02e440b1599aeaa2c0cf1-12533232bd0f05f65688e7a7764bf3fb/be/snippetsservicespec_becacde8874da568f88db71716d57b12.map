{"file":"C:\\Users\\timur\\Programming\\Projects\\snippetforge\\apps\\api\\test\\unit\\services\\snippets.service.spec.ts","mappings":"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","names":[],"sources":["C:\\Users\\timur\\Programming\\Projects\\snippetforge\\apps\\api\\test\\unit\\services\\snippets.service.spec.ts"],"sourcesContent":["// test/unit/services/snippets.service.spec.ts\r\n\r\nimport {\r\n  BadRequestException,\r\n  ForbiddenException,\r\n  NotFoundException,\r\n} from '@nestjs/common';\r\nimport { Test, TestingModule } from '@nestjs/testing';\r\nimport { SnippetsRepository } from '../../../src/modules/snippets/snippets.repository';\r\nimport { SnippetsService } from '../../../src/modules/snippets/snippets.service';\r\nimport {\r\n  createMockSnippet,\r\n  createMockSnippetsRepository,\r\n  type MockSnippetsRepository,\r\n} from '../../mocks';\r\n\r\n/**\r\n * SnippetsService Unit Tests\r\n *\r\n * Tests:\r\n * - Business Logic (Ownership, Public/Private)\r\n * - Error Handling (NotFoundException, ForbiddenException)\r\n * - Input Validation\r\n * - Orchestration of Repository Calls\r\n */\r\ndescribe('SnippetsService', () => {\r\n  let service: SnippetsService;\r\n  let repository: MockSnippetsRepository;\r\n\r\n  const mockSnippet = createMockSnippet();\r\n  const ownerId = 'owner-user-id';\r\n  const otherUserId = 'other-user-id';\r\n\r\n  beforeEach(async () => {\r\n    repository = createMockSnippetsRepository();\r\n\r\n    const module: TestingModule = await Test.createTestingModule({\r\n      providers: [\r\n        SnippetsService,\r\n        {\r\n          provide: SnippetsRepository,\r\n          useValue: repository,\r\n        },\r\n      ],\r\n    }).compile();\r\n\r\n    service = module.get<SnippetsService>(SnippetsService);\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  // ============================================================\r\n  // CREATE\r\n  // ============================================================\r\n\r\n  describe('create', () => {\r\n    it('should create a new snippet', async () => {\r\n      // Arrange\r\n      const dto = {\r\n        title: 'Test Snippet',\r\n        code: 'console.log(\"test\")',\r\n        language: 'javascript',\r\n      };\r\n      repository.create.mockResolvedValue(mockSnippet);\r\n\r\n      // Act\r\n      const result = await service.create(ownerId, dto);\r\n\r\n      // Assert\r\n      expect(result).toEqual(mockSnippet);\r\n      expect(repository.create).toHaveBeenCalledWith({\r\n        ...dto,\r\n        userId: ownerId,\r\n        isPublic: true, // Default\r\n      });\r\n    });\r\n\r\n    it('should use provided isPublic value', async () => {\r\n      // Arrange\r\n      const dto = {\r\n        title: 'Private Snippet',\r\n        code: 'console.log(\"secret\")',\r\n        language: 'javascript',\r\n        isPublic: false,\r\n      };\r\n      repository.create.mockResolvedValue(mockSnippet);\r\n\r\n      // Act\r\n      await service.create(ownerId, dto);\r\n\r\n      // Assert\r\n      expect(repository.create).toHaveBeenCalledWith(\r\n        expect.objectContaining({ isPublic: false }),\r\n      );\r\n    });\r\n\r\n    it('should throw BadRequestException for empty code', async () => {\r\n      // Arrange\r\n      const dto = {\r\n        title: 'Test',\r\n        code: '   ', // Only whitespace\r\n        language: 'javascript',\r\n      };\r\n\r\n      // Act & Assert\r\n      await expect(service.create(ownerId, dto)).rejects.toThrow(\r\n        BadRequestException,\r\n      );\r\n      await expect(service.create(ownerId, dto)).rejects.toThrow(\r\n        'Code cannot be empty or contain only whitespace',\r\n      );\r\n    });\r\n\r\n    it('should throw BadRequestException for code > 50000 chars', async () => {\r\n      // Arrange\r\n      const dto = {\r\n        title: 'Test',\r\n        code: 'x'.repeat(50001),\r\n        language: 'javascript',\r\n      };\r\n\r\n      // Act & Assert\r\n      await expect(service.create(ownerId, dto)).rejects.toThrow(\r\n        BadRequestException,\r\n      );\r\n      await expect(service.create(ownerId, dto)).rejects.toThrow(\r\n        'Code exceeds maximum length of 50,000 characters',\r\n      );\r\n    });\r\n\r\n    it('should throw BadRequestException for empty title', async () => {\r\n      // Arrange\r\n      const dto = {\r\n        title: '   ', // Only whitespace\r\n        code: 'console.log(\"test\")',\r\n        language: 'javascript',\r\n      };\r\n\r\n      // Act & Assert\r\n      await expect(service.create(ownerId, dto)).rejects.toThrow(\r\n        BadRequestException,\r\n      );\r\n      await expect(service.create(ownerId, dto)).rejects.toThrow(\r\n        'Title cannot be empty or contain only whitespace',\r\n      );\r\n    });\r\n  });\r\n\r\n  // ============================================================\r\n  // READ - SINGLE\r\n  // ============================================================\r\n\r\n  describe('findById', () => {\r\n    it('should return public snippet without userId', async () => {\r\n      // Arrange\r\n      const publicSnippet = createMockSnippet({ isPublic: true });\r\n      repository.findById.mockResolvedValue(publicSnippet);\r\n\r\n      // Act\r\n      const result = await service.findById('snippet-id');\r\n\r\n      // Assert\r\n      expect(result).toEqual(publicSnippet);\r\n    });\r\n\r\n    it('should return public snippet with any userId', async () => {\r\n      // Arrange\r\n      const publicSnippet = createMockSnippet({\r\n        isPublic: true,\r\n        userId: ownerId,\r\n      });\r\n      repository.findById.mockResolvedValue(publicSnippet);\r\n\r\n      // Act\r\n      const result = await service.findById('snippet-id', otherUserId);\r\n\r\n      // Assert\r\n      expect(result).toEqual(publicSnippet);\r\n    });\r\n\r\n    it('should return private snippet for owner', async () => {\r\n      // Arrange\r\n      const privateSnippet = createMockSnippet({\r\n        isPublic: false,\r\n        userId: ownerId,\r\n      });\r\n      repository.findById.mockResolvedValue(privateSnippet);\r\n\r\n      // Act\r\n      const result = await service.findById('snippet-id', ownerId);\r\n\r\n      // Assert\r\n      expect(result).toEqual(privateSnippet);\r\n    });\r\n\r\n    it('should throw ForbiddenException for private snippet of other user', async () => {\r\n      // Arrange\r\n      const privateSnippet = createMockSnippet({\r\n        isPublic: false,\r\n        userId: ownerId,\r\n      });\r\n      repository.findById.mockResolvedValue(privateSnippet);\r\n\r\n      // Act & Assert\r\n      await expect(service.findById('snippet-id', otherUserId)).rejects.toThrow(\r\n        ForbiddenException,\r\n      );\r\n      await expect(service.findById('snippet-id', otherUserId)).rejects.toThrow(\r\n        'You do not have access to this snippet',\r\n      );\r\n    });\r\n\r\n    it('should throw NotFoundException when snippet not found', async () => {\r\n      // Arrange\r\n      repository.findById.mockResolvedValue(null);\r\n\r\n      // Act & Assert\r\n      await expect(service.findById('nonexistent')).rejects.toThrow(\r\n        NotFoundException,\r\n      );\r\n      await expect(service.findById('nonexistent')).rejects.toThrow(\r\n        'Snippet with ID nonexistent not found',\r\n      );\r\n    });\r\n  });\r\n\r\n  describe('findByIdAndIncrementViews', () => {\r\n    it('should return snippet and increment views', async () => {\r\n      // Arrange\r\n      const publicSnippet = createMockSnippet({ isPublic: true });\r\n      repository.findById.mockResolvedValue(publicSnippet);\r\n      repository.incrementViewCount.mockResolvedValue(true);\r\n\r\n      // Act\r\n      const result = await service.findByIdAndIncrementViews('snippet-id');\r\n\r\n      // Assert\r\n      expect(result).toEqual(publicSnippet);\r\n      // incrementViewCount is fire-and-forget, so we can't reliably test it was called\r\n    });\r\n\r\n    it('should not fail if incrementViewCount fails', async () => {\r\n      // Arrange\r\n      const publicSnippet = createMockSnippet({ isPublic: true });\r\n      repository.findById.mockResolvedValue(publicSnippet);\r\n      repository.incrementViewCount.mockRejectedValue(new Error('DB Error'));\r\n\r\n      // Act - Should NOT throw\r\n      const result = await service.findByIdAndIncrementViews('snippet-id');\r\n\r\n      // Assert\r\n      expect(result).toEqual(publicSnippet);\r\n    });\r\n  });\r\n\r\n  // ============================================================\r\n  // READ - LISTS\r\n  // ============================================================\r\n\r\n  describe('findUserSnippets', () => {\r\n    it('should return user snippets', async () => {\r\n      // Arrange\r\n      const snippets = [mockSnippet];\r\n      repository.findByUserId.mockResolvedValue(snippets);\r\n\r\n      // Act\r\n      const result = await service.findUserSnippets(ownerId);\r\n\r\n      // Assert\r\n      expect(result).toEqual(snippets);\r\n      expect(repository.findByUserId).toHaveBeenCalledWith(ownerId, 20);\r\n    });\r\n\r\n    it('should use custom limit', async () => {\r\n      // Arrange\r\n      repository.findByUserId.mockResolvedValue([]);\r\n\r\n      // Act\r\n      await service.findUserSnippets(ownerId, 50);\r\n\r\n      // Assert\r\n      expect(repository.findByUserId).toHaveBeenCalledWith(ownerId, 50);\r\n    });\r\n  });\r\n\r\n  describe('findPublicSnippets', () => {\r\n    it('should return paginated public snippets', async () => {\r\n      // Arrange\r\n      const paginatedResult = {\r\n        data: [mockSnippet],\r\n        meta: {\r\n          page: 1,\r\n          limit: 20,\r\n          total: 100,\r\n          totalPages: 5,\r\n          hasNextPage: true,\r\n          hasPreviousPage: false,\r\n        },\r\n      };\r\n      repository.findPublic.mockResolvedValue(paginatedResult);\r\n\r\n      // Act\r\n      const result = await service.findPublicSnippets(1, 20);\r\n\r\n      // Assert\r\n      expect(result).toEqual(paginatedResult);\r\n    });\r\n\r\n    it('should enforce minimum page of 1', async () => {\r\n      // Arrange\r\n\r\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\r\n      repository.findPublic.mockResolvedValue({ data: [], meta: {} as any });\r\n\r\n      // Act\r\n      await service.findPublicSnippets(0, 20);\r\n\r\n      // Assert\r\n      expect(repository.findPublic).toHaveBeenCalledWith(1, 20);\r\n    });\r\n\r\n    it('should enforce maximum limit of 100', async () => {\r\n      // Arrange\r\n\r\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\r\n      repository.findPublic.mockResolvedValue({ data: [], meta: {} as any });\r\n\r\n      // Act\r\n      await service.findPublicSnippets(1, 200);\r\n\r\n      // Assert\r\n      expect(repository.findPublic).toHaveBeenCalledWith(1, 100);\r\n    });\r\n  });\r\n\r\n  // ============================================================\r\n  // UPDATE\r\n  // ============================================================\r\n\r\n  describe('update', () => {\r\n    it('should update own snippet', async () => {\r\n      // Arrange\r\n      const existingSnippet = createMockSnippet({ userId: ownerId });\r\n      const updatedSnippet = { ...existingSnippet, title: 'Updated' };\r\n      repository.findById.mockResolvedValue(existingSnippet);\r\n      repository.update.mockResolvedValue(updatedSnippet);\r\n\r\n      // Act\r\n      const result = await service.update('snippet-id', ownerId, 'USER', {\r\n        title: 'Updated',\r\n      });\r\n\r\n      // Assert\r\n      expect(result.title).toBe('Updated');\r\n      expect(repository.update).toHaveBeenCalledWith('snippet-id', {\r\n        title: 'Updated',\r\n      });\r\n    });\r\n\r\n    it('should throw ForbiddenException when updating other user snippet', async () => {\r\n      // Arrange\r\n      const existingSnippet = createMockSnippet({ userId: ownerId });\r\n      repository.findById.mockResolvedValue(existingSnippet);\r\n\r\n      // Act & Assert\r\n      await expect(\r\n        service.update('snippet-id', otherUserId, 'USER', { title: 'Updated' }),\r\n      ).rejects.toThrow(ForbiddenException);\r\n      await expect(\r\n        service.update('snippet-id', otherUserId, 'USER', { title: 'Updated' }),\r\n      ).rejects.toThrow('You can only modify your own snippets');\r\n    });\r\n\r\n    it('should allow ADMIN to update any snippet', async () => {\r\n      // Arrange\r\n      const existingSnippet = createMockSnippet({ userId: ownerId });\r\n      const updatedSnippet = { ...existingSnippet, title: 'Admin Updated' };\r\n      repository.findById.mockResolvedValue(existingSnippet);\r\n      repository.update.mockResolvedValue(updatedSnippet);\r\n\r\n      // Act\r\n      const result = await service.update('snippet-id', otherUserId, 'ADMIN', {\r\n        title: 'Admin Updated',\r\n      });\r\n\r\n      // Assert\r\n      expect(result.title).toBe('Admin Updated');\r\n    });\r\n\r\n    it('should throw NotFoundException when snippet not found', async () => {\r\n      // Arrange\r\n      repository.findById.mockResolvedValue(null);\r\n\r\n      // Act & Assert\r\n      await expect(\r\n        service.update('nonexistent', ownerId, 'USER', { title: 'Updated' }),\r\n      ).rejects.toThrow(NotFoundException);\r\n    });\r\n\r\n    it('should validate new data', async () => {\r\n      // Arrange\r\n      const existingSnippet = createMockSnippet({ userId: ownerId });\r\n      repository.findById.mockResolvedValue(existingSnippet);\r\n\r\n      // Act & Assert - Empty title\r\n      await expect(\r\n        service.update('snippet-id', ownerId, 'USER', { title: '   ' }),\r\n      ).rejects.toThrow(BadRequestException);\r\n    });\r\n  });\r\n\r\n  describe('togglePublic', () => {\r\n    it('should toggle public to private', async () => {\r\n      // Arrange\r\n      const publicSnippet = createMockSnippet({\r\n        userId: ownerId,\r\n        isPublic: true,\r\n      });\r\n      const privateSnippet = { ...publicSnippet, isPublic: false };\r\n      repository.findById.mockResolvedValue(publicSnippet);\r\n      repository.update.mockResolvedValue(privateSnippet);\r\n\r\n      // Act\r\n      const result = await service.togglePublic('snippet-id', ownerId, 'USER');\r\n\r\n      // Assert\r\n      expect(result.isPublic).toBe(false);\r\n      expect(repository.update).toHaveBeenCalledWith('snippet-id', {\r\n        isPublic: false,\r\n      });\r\n    });\r\n\r\n    it('should toggle private to public', async () => {\r\n      // Arrange\r\n      const privateSnippet = createMockSnippet({\r\n        userId: ownerId,\r\n        isPublic: false,\r\n      });\r\n      const publicSnippet = { ...privateSnippet, isPublic: true };\r\n      repository.findById.mockResolvedValue(privateSnippet);\r\n      repository.update.mockResolvedValue(publicSnippet);\r\n\r\n      // Act\r\n      const result = await service.togglePublic('snippet-id', ownerId, 'USER');\r\n\r\n      // Assert\r\n      expect(result.isPublic).toBe(true);\r\n    });\r\n\r\n    it('should throw ForbiddenException for other user', async () => {\r\n      // Arrange\r\n      const snippet = createMockSnippet({ userId: ownerId });\r\n      repository.findById.mockResolvedValue(snippet);\r\n\r\n      // Act & Assert\r\n      await expect(\r\n        service.togglePublic('snippet-id', otherUserId, 'USER'),\r\n      ).rejects.toThrow(ForbiddenException);\r\n    });\r\n  });\r\n\r\n  // ============================================================\r\n  // DELETE\r\n  // ============================================================\r\n\r\n  describe('delete', () => {\r\n    it('should delete own snippet', async () => {\r\n      // Arrange\r\n      const snippet = createMockSnippet({ userId: ownerId });\r\n      repository.findById.mockResolvedValue(snippet);\r\n      repository.delete.mockResolvedValue(true);\r\n\r\n      // Act\r\n      await service.delete('snippet-id', ownerId, 'USER');\r\n\r\n      // Assert\r\n      expect(repository.delete).toHaveBeenCalledWith('snippet-id');\r\n    });\r\n\r\n    it('should throw ForbiddenException when deleting other user snippet', async () => {\r\n      // Arrange\r\n      const snippet = createMockSnippet({ userId: ownerId });\r\n      repository.findById.mockResolvedValue(snippet);\r\n\r\n      // Act & Assert\r\n      await expect(\r\n        service.delete('snippet-id', otherUserId, 'USER'),\r\n      ).rejects.toThrow(ForbiddenException);\r\n      await expect(\r\n        service.delete('snippet-id', otherUserId, 'USER'),\r\n      ).rejects.toThrow('You can only delete your own snippets');\r\n    });\r\n\r\n    it('should allow ADMIN to delete any snippet', async () => {\r\n      // Arrange\r\n      const snippet = createMockSnippet({ userId: ownerId });\r\n      repository.findById.mockResolvedValue(snippet);\r\n      repository.delete.mockResolvedValue(true);\r\n\r\n      // Act\r\n      await service.delete('snippet-id', otherUserId, 'ADMIN');\r\n\r\n      // Assert\r\n      expect(repository.delete).toHaveBeenCalledWith('snippet-id');\r\n    });\r\n\r\n    it('should throw NotFoundException when snippet not found', async () => {\r\n      // Arrange\r\n      repository.findById.mockResolvedValue(null);\r\n\r\n      // Act & Assert\r\n      await expect(\r\n        service.delete('nonexistent', ownerId, 'USER'),\r\n      ).rejects.toThrow(NotFoundException);\r\n    });\r\n  });\r\n\r\n  // ============================================================\r\n  // STATISTICS\r\n  // ============================================================\r\n\r\n  describe('getUserStats', () => {\r\n    it('should return user statistics', async () => {\r\n      // Arrange\r\n      const stats = {\r\n        total: 10,\r\n        public: 7,\r\n        private: 3,\r\n        totalViews: 150,\r\n        mostViewed: mockSnippet,\r\n        latestSnippet: mockSnippet,\r\n      };\r\n      repository.getUserStats.mockResolvedValue(stats);\r\n\r\n      // Act\r\n      const result = await service.getUserStats(ownerId);\r\n\r\n      // Assert\r\n      expect(result).toEqual(stats);\r\n    });\r\n  });\r\n\r\n  describe('countUserSnippets', () => {\r\n    it('should return count of user snippets', async () => {\r\n      // Arrange\r\n      repository.countByUserId.mockResolvedValue(42);\r\n\r\n      // Act\r\n      const result = await service.countUserSnippets(ownerId);\r\n\r\n      // Assert\r\n      expect(result).toBe(42);\r\n    });\r\n  });\r\n});\r\n"],"version":3}