{"file":"/home/runner/work/snippetforge/snippetforge/apps/api/src/modules/auth/decorators/current-user.decorator.ts","mappings":";AAAA,wDAAwD;;;AAExD,2CAAwE;AAIxE;;;;;;;;;;;;;;;;;;;;;;;;GAwBG;AACI,MAAM,kBAAkB,GAAG,CAChC,IAAgC,EAChC,GAAqB,EACrB,EAAE;IACF,MAAM,OAAO,GAAG,GAAG,CAAC,YAAY,EAAE,CAAC,UAAU,EAAW,CAAC;IACzD,MAAM,IAAI,GAAG,OAAO,CAAC,IAA4B,CAAC;IAElD,IAAI,CAAC,IAAI,EAAE,CAAC;QACV,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,IAAI,IAAI,EAAE,CAAC;QACT,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;IACpB,CAAC;IAED,OAAO,IAAI,CAAC;AACd,CAAC,CAAC;AAhBW,QAAA,kBAAkB,sBAgB7B;AAEW,QAAA,WAAW,GAAG,IAAA,6BAAoB,EAAC,0BAAkB,CAAC,CAAC","names":[],"sources":["/home/runner/work/snippetforge/snippetforge/apps/api/src/modules/auth/decorators/current-user.decorator.ts"],"sourcesContent":["// src/modules/auth/decorators/current-user.decorator.ts\n\nimport { createParamDecorator, ExecutionContext } from '@nestjs/common';\nimport { Request } from 'express';\nimport { type SafeUser } from '../../users';\n\n/**\n * @CurrentUser() Decorator - Injiziert aktuellen User in Controller-Methode\n *\n * WARUM als Decorator statt request.user?\n * 1. Typsicherheit:  Decorator gibt SafeUser zurÃ¼ck, nicht any\n * 2. Clean Code: Controller-Methode zeigt klar welche Daten sie braucht\n * 3. Testbar: Decorator kann gemockt werden\n *\n * VERWENDUNG:\n * @Get('me')\n * @UseGuards(JwtAuthGuard)\n * getProfile(@CurrentUser() user: SafeUser) {\n *   return user\n * }\n *\n * // Mit Property-Zugriff\n * @Get('my-email')\n * @UseGuards(JwtAuthGuard)\n * getEmail(@CurrentUser('email') email: string) {\n *   return { email }\n * }\n *\n * VORAUSSETZUNG: JwtAuthGuard muss aktiv sein!\n * Sonst ist request.user undefined\n */\nexport const currentUserFactory = (\n  data: keyof SafeUser | undefined,\n  ctx: ExecutionContext,\n) => {\n  const request = ctx.switchToHttp().getRequest<Request>();\n  const user = request.user as SafeUser | undefined;\n\n  if (!user) {\n    return undefined;\n  }\n\n  if (data) {\n    return user[data];\n  }\n\n  return user;\n};\n\nexport const CurrentUser = createParamDecorator(currentUserFactory);\n"],"version":3}