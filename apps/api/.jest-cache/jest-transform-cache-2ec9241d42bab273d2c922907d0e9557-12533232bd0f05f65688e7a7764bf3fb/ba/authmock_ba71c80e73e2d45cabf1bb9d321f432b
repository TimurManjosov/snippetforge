cc8f71b7389c5d48b0447c8b90b1e1bc
"use strict";
// test/mocks/auth.mock.ts
Object.defineProperty(exports, "__esModule", { value: true });
exports.createMockReflector = exports.createMockJwtService = exports.createMockAuthService = void 0;
exports.createMockTokenResponse = createMockTokenResponse;
exports.createMockAuthResponse = createMockAuthResponse;
exports.createMockJwtPayload = createMockJwtPayload;
const users_mock_1 = require("./users.mock");
/**
 * Auth Mocks
 *
 * Mock-Implementierungen fÃ¼r AuthService und JwtService.
 */
// ========================================
// SERVICE MOCKS
// ========================================
const createMockAuthService = () => ({
    register: jest.fn(),
    login: jest.fn(),
    validateUserById: jest.fn(),
    getCurrentUser: jest.fn(),
});
exports.createMockAuthService = createMockAuthService;
const createMockJwtService = () => ({
    sign: jest.fn().mockReturnValue('mock-jwt-token'),
    signAsync: jest.fn().mockResolvedValue('mock-jwt-token'),
    verify: jest
        .fn()
        .mockReturnValue({ sub: 'user-id', email: 'test@test.com', role: 'USER' }),
    verifyAsync: jest.fn().mockResolvedValue({
        sub: 'user-id',
        email: 'test@test.com',
        role: 'USER',
    }),
    decode: jest
        .fn()
        .mockReturnValue({ sub: 'user-id', email: 'test@test.com', role: 'USER' }),
});
exports.createMockJwtService = createMockJwtService;
// ========================================
// REFLECTOR MOCK
// ========================================
const createMockReflector = () => ({
    get: jest.fn(),
    getAll: jest.fn(),
    getAllAndMerge: jest.fn(),
    getAllAndOverride: jest.fn(),
});
exports.createMockReflector = createMockReflector;
// ========================================
// TEST DATA
// ========================================
/**
 * Erstellt eine Mock TokenResponse
 */
function createMockTokenResponse() {
    return {
        accessToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0LXVzZXItaWQiLCJlbWFpbCI6InRlc3RAdGVzdC5jb20iLCJyb2xlIjoiVVNFUiJ9.mock-signature',
        tokenType: 'Bearer',
        expiresIn: 900,
    };
}
/**
 * Erstellt eine Mock AuthResponse
 */
function createMockAuthResponse(userOverrides = {}) {
    return {
        user: (0, users_mock_1.createMockSafeUser)(userOverrides),
        tokens: createMockTokenResponse(),
    };
}
/**
 * Erstellt einen Mock JWT Payload
 */
function createMockJwtPayload(overrides = {}) {
    return {
        sub: 'test-user-id-123',
        email: 'test@example.com',
        role: 'USER',
        iat: Math.floor(Date.now() / 1000),
        exp: Math.floor(Date.now() / 1000) + 900,
        ...overrides,
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmsvc25pcHBldGZvcmdlL3NuaXBwZXRmb3JnZS9hcHBzL2FwaS90ZXN0L21vY2tzL2F1dGgubW9jay50cyIsIm1hcHBpbmdzIjoiO0FBQUEsMEJBQTBCOzs7QUErRDFCLDBEQU9DO0FBS0Qsd0RBS0M7QUFLRCxvREFTQztBQTFGRCw2Q0FBa0Q7QUFFbEQ7Ozs7R0FJRztBQUVILDJDQUEyQztBQUMzQyxnQkFBZ0I7QUFDaEIsMkNBQTJDO0FBRXBDLE1BQU0scUJBQXFCLEdBQUcsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUMxQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNuQixLQUFLLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNoQixnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQzNCLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQzFCLENBQUMsQ0FBQztBQUxVLFFBQUEscUJBQXFCLHlCQUsvQjtBQUlJLE1BQU0sb0JBQW9CLEdBQUcsR0FBd0IsRUFBRSxDQUFDLENBQUM7SUFDOUQsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLENBQUM7SUFDakQsU0FBUyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxnQkFBZ0IsQ0FBQztJQUN4RCxNQUFNLEVBQUUsSUFBSTtTQUNULEVBQUUsRUFBRTtTQUNKLGVBQWUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUM7SUFDNUUsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztRQUN2QyxHQUFHLEVBQUUsU0FBUztRQUNkLEtBQUssRUFBRSxlQUFlO1FBQ3RCLElBQUksRUFBRSxNQUFNO0tBQ2IsQ0FBQztJQUNGLE1BQU0sRUFBRSxJQUFJO1NBQ1QsRUFBRSxFQUFFO1NBQ0osZUFBZSxDQUFDLEVBQUUsR0FBRyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsZUFBZSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsQ0FBQztDQUM3RSxDQUFDLENBQUM7QUFkVSxRQUFBLG9CQUFvQix3QkFjOUI7QUFJSCwyQ0FBMkM7QUFDM0MsaUJBQWlCO0FBQ2pCLDJDQUEyQztBQUVwQyxNQUFNLG1CQUFtQixHQUFHLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDeEMsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZCxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNqQixjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUN6QixpQkFBaUIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQzdCLENBQUMsQ0FBQztBQUxVLFFBQUEsbUJBQW1CLHVCQUs3QjtBQUlILDJDQUEyQztBQUMzQyxZQUFZO0FBQ1osMkNBQTJDO0FBRTNDOztHQUVHO0FBQ0gsU0FBZ0IsdUJBQXVCO0lBQ3JDLE9BQU87UUFDTCxXQUFXLEVBQ1Qsc0lBQXNJO1FBQ3hJLFNBQVMsRUFBRSxRQUFRO1FBQ25CLFNBQVMsRUFBRSxHQUFHO0tBQ2YsQ0FBQztBQUNKLENBQUM7QUFFRDs7R0FFRztBQUNILFNBQWdCLHNCQUFzQixDQUFDLGFBQWEsR0FBRyxFQUFFO0lBQ3ZELE9BQU87UUFDTCxJQUFJLEVBQUUsSUFBQSwrQkFBa0IsRUFBQyxhQUFhLENBQUM7UUFDdkMsTUFBTSxFQUFFLHVCQUF1QixFQUFFO0tBQ2xDLENBQUM7QUFDSixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxTQUFnQixvQkFBb0IsQ0FBQyxTQUFTLEdBQUcsRUFBRTtJQUNqRCxPQUFPO1FBQ0wsR0FBRyxFQUFFLGtCQUFrQjtRQUN2QixLQUFLLEVBQUUsa0JBQWtCO1FBQ3pCLElBQUksRUFBRSxNQUFNO1FBQ1osR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQztRQUNsQyxHQUFHLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLEdBQUcsR0FBRztRQUN4QyxHQUFHLFNBQVM7S0FDYixDQUFDO0FBQ0osQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29yay9zbmlwcGV0Zm9yZ2Uvc25pcHBldGZvcmdlL2FwcHMvYXBpL3Rlc3QvbW9ja3MvYXV0aC5tb2NrLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHRlc3QvbW9ja3MvYXV0aC5tb2NrLnRzXG5cbmltcG9ydCB7IEp3dFNlcnZpY2UgfSBmcm9tICdAbmVzdGpzL2p3dCc7XG5pbXBvcnQgeyB0eXBlIEF1dGhSZXNwb25zZSwgdHlwZSBUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vc3JjL21vZHVsZXMvYXV0aCc7XG5pbXBvcnQgeyBjcmVhdGVNb2NrU2FmZVVzZXIgfSBmcm9tICcuL3VzZXJzLm1vY2snO1xuXG4vKipcbiAqIEF1dGggTW9ja3NcbiAqXG4gKiBNb2NrLUltcGxlbWVudGllcnVuZ2VuIGbDvHIgQXV0aFNlcnZpY2UgdW5kIEp3dFNlcnZpY2UuXG4gKi9cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU0VSVklDRSBNT0NLU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja0F1dGhTZXJ2aWNlID0gKCkgPT4gKHtcbiAgcmVnaXN0ZXI6IGplc3QuZm4oKSxcbiAgbG9naW46IGplc3QuZm4oKSxcbiAgdmFsaWRhdGVVc2VyQnlJZDogamVzdC5mbigpLFxuICBnZXRDdXJyZW50VXNlcjogamVzdC5mbigpLFxufSk7XG5cbmV4cG9ydCB0eXBlIE1vY2tBdXRoU2VydmljZSA9IFJldHVyblR5cGU8dHlwZW9mIGNyZWF0ZU1vY2tBdXRoU2VydmljZT47XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVNb2NrSnd0U2VydmljZSA9ICgpOiBQYXJ0aWFsPEp3dFNlcnZpY2U+ID0+ICh7XG4gIHNpZ246IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoJ21vY2stand0LXRva2VuJyksXG4gIHNpZ25Bc3luYzogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKCdtb2NrLWp3dC10b2tlbicpLFxuICB2ZXJpZnk6IGplc3RcbiAgICAuZm4oKVxuICAgIC5tb2NrUmV0dXJuVmFsdWUoeyBzdWI6ICd1c2VyLWlkJywgZW1haWw6ICd0ZXN0QHRlc3QuY29tJywgcm9sZTogJ1VTRVInIH0pLFxuICB2ZXJpZnlBc3luYzogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICBzdWI6ICd1c2VyLWlkJyxcbiAgICBlbWFpbDogJ3Rlc3RAdGVzdC5jb20nLFxuICAgIHJvbGU6ICdVU0VSJyxcbiAgfSksXG4gIGRlY29kZTogamVzdFxuICAgIC5mbigpXG4gICAgLm1vY2tSZXR1cm5WYWx1ZSh7IHN1YjogJ3VzZXItaWQnLCBlbWFpbDogJ3Rlc3RAdGVzdC5jb20nLCByb2xlOiAnVVNFUicgfSksXG59KTtcblxuZXhwb3J0IHR5cGUgTW9ja0p3dFNlcnZpY2UgPSBSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVNb2NrSnd0U2VydmljZT47XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFJFRkxFQ1RPUiBNT0NLXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVNb2NrUmVmbGVjdG9yID0gKCkgPT4gKHtcbiAgZ2V0OiBqZXN0LmZuKCksXG4gIGdldEFsbDogamVzdC5mbigpLFxuICBnZXRBbGxBbmRNZXJnZTogamVzdC5mbigpLFxuICBnZXRBbGxBbmRPdmVycmlkZTogamVzdC5mbigpLFxufSk7XG5cbmV4cG9ydCB0eXBlIE1vY2tSZWZsZWN0b3IgPSBSZXR1cm5UeXBlPHR5cGVvZiBjcmVhdGVNb2NrUmVmbGVjdG9yPjtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVEVTVCBEQVRBXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogRXJzdGVsbHQgZWluZSBNb2NrIFRva2VuUmVzcG9uc2VcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZU1vY2tUb2tlblJlc3BvbnNlKCk6IFRva2VuUmVzcG9uc2Uge1xuICByZXR1cm4ge1xuICAgIGFjY2Vzc1Rva2VuOlxuICAgICAgJ2V5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS5leUp6ZFdJaU9pSjBaWE4wTFhWelpYSXRhV1FpTENKbGJXRnBiQ0k2SW5SbGMzUkFkR1Z6ZEM1amIyMGlMQ0p5YjJ4bElqb2lWVk5GVWlKOS5tb2NrLXNpZ25hdHVyZScsXG4gICAgdG9rZW5UeXBlOiAnQmVhcmVyJyxcbiAgICBleHBpcmVzSW46IDkwMCxcbiAgfTtcbn1cblxuLyoqXG4gKiBFcnN0ZWxsdCBlaW5lIE1vY2sgQXV0aFJlc3BvbnNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNb2NrQXV0aFJlc3BvbnNlKHVzZXJPdmVycmlkZXMgPSB7fSk6IEF1dGhSZXNwb25zZSB7XG4gIHJldHVybiB7XG4gICAgdXNlcjogY3JlYXRlTW9ja1NhZmVVc2VyKHVzZXJPdmVycmlkZXMpLFxuICAgIHRva2VuczogY3JlYXRlTW9ja1Rva2VuUmVzcG9uc2UoKSxcbiAgfTtcbn1cblxuLyoqXG4gKiBFcnN0ZWxsdCBlaW5lbiBNb2NrIEpXVCBQYXlsb2FkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNb2NrSnd0UGF5bG9hZChvdmVycmlkZXMgPSB7fSkge1xuICByZXR1cm4ge1xuICAgIHN1YjogJ3Rlc3QtdXNlci1pZC0xMjMnLFxuICAgIGVtYWlsOiAndGVzdEBleGFtcGxlLmNvbScsXG4gICAgcm9sZTogJ1VTRVInLFxuICAgIGlhdDogTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCksXG4gICAgZXhwOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArIDkwMCxcbiAgICAuLi5vdmVycmlkZXMsXG4gIH07XG59XG4iXSwidmVyc2lvbiI6M30=