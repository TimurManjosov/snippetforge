622afe1acc261c985186a4f4be717698
"use strict";
// test/unit/dto/snippets/create-snippet.dto.spec.ts
Object.defineProperty(exports, "__esModule", { value: true });
const create_snippet_dto_1 = require("../../../../src/modules/snippets/dto/create-snippet.dto");
/**
 * CreateSnippetDto Unit Tests
 *
 * Testet:
 * - Valide Daten werden transformiert
 * - Invalide Daten werden abgelehnt
 * - Transformationen (trim, lowercase) funktionieren
 * - Validierung Rules eingehalten werden
 */
describe('CreateSnippetDto', () => {
    describe('CreateSnippetSchema', () => {
        describe('with valid data', () => {
            it('should validate a complete snippet with all fields', () => {
                // Arrange
                const input = {
                    title: 'Test Snippet',
                    description: 'This is a test snippet',
                    code: 'console.log("Hello World");',
                    language: 'javascript',
                    isPublic: true,
                };
                // Act
                const result = create_snippet_dto_1.CreateSnippetSchema.parse(input);
                // Assert
                expect(result.title).toBe('Test Snippet');
                expect(result.description).toBe('This is a test snippet');
                expect(result.code).toBe('console.log("Hello World");');
                expect(result.language).toBe('javascript');
                expect(result.isPublic).toBe(true);
            });
            it('should validate snippet without optional fields', () => {
                // Arrange
                const input = {
                    title: 'Minimal Snippet',
                    code: 'print("Hello")',
                    language: 'python',
                };
                // Act
                const result = create_snippet_dto_1.CreateSnippetSchema.parse(input);
                // Assert
                expect(result.title).toBe('Minimal Snippet');
                expect(result.code).toBe('print("Hello")');
                expect(result.language).toBe('python');
                expect(result.description).toBeUndefined();
                expect(result.isPublic).toBe(true); // default value
            });
            it('should trim whitespace from title', () => {
                // Arrange
                const input = {
                    title: '  Trimmed Title  ',
                    code: 'code',
                    language: 'typescript',
                };
                // Act
                const result = create_snippet_dto_1.CreateSnippetSchema.parse(input);
                // Assert
                expect(result.title).toBe('Trimmed Title');
            });
            it('should trim whitespace from description', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    description: '  Trimmed Description  ',
                    code: 'code',
                    language: 'typescript',
                };
                // Act
                const result = create_snippet_dto_1.CreateSnippetSchema.parse(input);
                // Assert
                expect(result.description).toBe('Trimmed Description');
            });
            it('should convert language to lowercase', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'code',
                    language: 'TypeScript',
                };
                // Act
                const result = create_snippet_dto_1.CreateSnippetSchema.parse(input);
                // Assert
                expect(result.language).toBe('typescript');
            });
            it('should accept hyphenated language names', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'code',
                    language: 'c-sharp',
                };
                // Act
                const result = create_snippet_dto_1.CreateSnippetSchema.parse(input);
                // Assert
                expect(result.language).toBe('c-sharp');
            });
            it('should accept numeric language names', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'code',
                    language: 'c99',
                };
                // Act
                const result = create_snippet_dto_1.CreateSnippetSchema.parse(input);
                // Assert
                expect(result.language).toBe('c99');
            });
        });
        describe('with invalid data', () => {
            it('should reject empty title', () => {
                // Arrange
                const input = {
                    title: '',
                    code: 'code',
                    language: 'javascript',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject title exceeding 200 characters', () => {
                // Arrange
                const input = {
                    title: 'a'.repeat(201),
                    code: 'code',
                    language: 'javascript',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject description exceeding 1000 characters', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    description: 'a'.repeat(1001),
                    code: 'code',
                    language: 'javascript',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject empty code', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: '',
                    language: 'javascript',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject code exceeding 50000 characters', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'a'.repeat(50001),
                    language: 'javascript',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject empty language', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'code',
                    language: '',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject language with spaces', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'code',
                    language: 'java script',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject language with uppercase and special chars', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'code',
                    language: 'JavaScript!',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject missing required fields', () => {
                // Arrange
                const input = {
                    title: 'Test',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
            it('should reject invalid isPublic type', () => {
                // Arrange
                const input = {
                    title: 'Test',
                    code: 'code',
                    language: 'javascript',
                    isPublic: 'yes',
                };
                // Act & Assert
                expect(() => create_snippet_dto_1.CreateSnippetSchema.parse(input)).toThrow();
            });
        });
    });
    describe('validateCreateSnippetDto', () => {
        it('should parse valid data', () => {
            // Arrange
            const input = {
                title: 'Test',
                code: 'console.log("test");',
                language: 'javascript',
            };
            // Act
            const result = (0, create_snippet_dto_1.validateCreateSnippetDto)(input);
            // Assert
            expect(result).toBeDefined();
            expect(result.title).toBe('Test');
        });
        it('should throw on invalid data', () => {
            // Arrange
            const input = {
                title: '',
                code: 'code',
                language: 'javascript',
            };
            // Act & Assert
            expect(() => (0, create_snippet_dto_1.validateCreateSnippetDto)(input)).toThrow();
        });
    });
    describe('safeValidateCreateSnippetDto', () => {
        it('should return success for valid data', () => {
            // Arrange
            const input = {
                title: 'Test',
                code: 'code',
                language: 'javascript',
            };
            // Act
            const result = (0, create_snippet_dto_1.safeValidateCreateSnippetDto)(input);
            // Assert
            expect(result.success).toBe(true);
            if (result.success) {
                expect(result.data.title).toBe('Test');
            }
        });
        it('should return error for invalid data', () => {
            // Arrange
            const input = {
                title: '',
                code: 'code',
                language: 'javascript',
            };
            // Act
            const result = (0, create_snippet_dto_1.safeValidateCreateSnippetDto)(input);
            // Assert
            expect(result.success).toBe(false);
            if (!result.success) {
                expect(result.error).toBeDefined();
            }
        });
    });
    describe('type inference', () => {
        it('should infer correct TypeScript type', () => {
            // Arrange
            const snippet = {
                title: 'Test',
                code: 'code',
                language: 'javascript',
                description: 'optional',
                isPublic: false,
            };
            // Assert - TypeScript should not complain
            expect(snippet.title).toBeDefined();
            expect(snippet.code).toBeDefined();
            expect(snippet.language).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmsvc25pcHBldGZvcmdlL3NuaXBwZXRmb3JnZS9hcHBzL2FwaS90ZXN0L3VuaXQvZHRvL3NuaXBwZXRzL2NyZWF0ZS1zbmlwcGV0LmR0by5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQSxvREFBb0Q7O0FBRXBELGdHQUtpRTtBQUVqRTs7Ozs7Ozs7R0FRRztBQUNILFFBQVEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7SUFDaEMsUUFBUSxDQUFDLHFCQUFxQixFQUFFLEdBQUcsRUFBRTtRQUNuQyxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO1lBQy9CLEVBQUUsQ0FBQyxvREFBb0QsRUFBRSxHQUFHLEVBQUU7Z0JBQzVELFVBQVU7Z0JBQ1YsTUFBTSxLQUFLLEdBQUc7b0JBQ1osS0FBSyxFQUFFLGNBQWM7b0JBQ3JCLFdBQVcsRUFBRSx3QkFBd0I7b0JBQ3JDLElBQUksRUFBRSw2QkFBNkI7b0JBQ25DLFFBQVEsRUFBRSxZQUFZO29CQUN0QixRQUFRLEVBQUUsSUFBSTtpQkFDZixDQUFDO2dCQUVGLE1BQU07Z0JBQ04sTUFBTSxNQUFNLEdBQUcsd0NBQW1CLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUVoRCxTQUFTO2dCQUNULE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO2dCQUMxQyxNQUFNLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO2dCQUMxRCxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO2dCQUN4RCxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFDM0MsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFD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RixNQUFNO1lBQ04sTUFBTSxNQUFNLEdBQUcsSUFBQSxpREFBNEIsRUFBQyxLQUFLLENBQUMsQ0FBQztZQUVuRCxTQUFTO1lBQ1QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQztnQkFDcEIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNyQyxDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLEdBQUcsRUFBRTtZQUM5QyxVQUFVO1lBQ1YsTUFBTSxPQUFPLEdBQXFCO2dCQUNoQyxLQUFLLEVBQUUsTUFBTTtnQkFDYixJQUFJLEVBQUUsTUFBTTtnQkFDWixRQUFRLEVBQUUsWUFBWTtnQkFDdEIsV0FBVyxFQUFFLFVBQVU7Z0JBQ3ZCLFFBQVEsRUFBRSxLQUFLO2FBQ2hCLENBQUM7WUFFRiwwQ0FBMEM7WUFDMUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDekMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3JrL3NuaXBwZXRmb3JnZS9zbmlwcGV0Zm9yZ2UvYXBwcy9hcGkvdGVzdC91bml0L2R0by9zbmlwcGV0cy9jcmVhdGUtc25pcHBldC5kdG8uc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0ZXN0L3VuaXQvZHRvL3NuaXBwZXRzL2NyZWF0ZS1zbmlwcGV0LmR0by5zcGVjLnRzXG5cbmltcG9ydCB7XG4gIENyZWF0ZVNuaXBwZXRTY2hlbWEsXG4gIHZhbGlkYXRlQ3JlYXRlU25pcHBldER0byxcbiAgc2FmZVZhbGlkYXRlQ3JlYXRlU25pcHBldER0byxcbiAgdHlwZSBDcmVhdGVTbmlwcGV0RHRvLFxufSBmcm9tICcuLi8uLi8uLi8uLi9zcmMvbW9kdWxlcy9zbmlwcGV0cy9kdG8vY3JlYXRlLXNuaXBwZXQuZHRvJztcblxuLyoqXG4gKiBDcmVhdGVTbmlwcGV0RHRvIFVuaXQgVGVzdHNcbiAqXG4gKiBUZXN0ZXQ6XG4gKiAtIFZhbGlkZSBEYXRlbiB3ZXJkZW4gdHJhbnNmb3JtaWVydFxuICogLSBJbnZhbGlkZSBEYXRlbiB3ZXJkZW4gYWJnZWxlaG50XG4gKiAtIFRyYW5zZm9ybWF0aW9uZW4gKHRyaW0sIGxvd2VyY2FzZSkgZnVua3Rpb25pZXJlblxuICogLSBWYWxpZGllcnVuZyBSdWxlcyBlaW5nZWhhbHRlbiB3ZXJkZW5cbiAqL1xuZGVzY3JpYmUoJ0NyZWF0ZVNuaXBwZXREdG8nLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdDcmVhdGVTbmlwcGV0U2NoZW1hJywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCd3aXRoIHZhbGlkIGRhdGEnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGEgY29tcGxldGUgc25pcHBldCB3aXRoIGFsbCBmaWVsZHMnLCAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgaW5wdXQgPSB7XG4gICAgICAgICAgdGl0bGU6ICdUZXN0IFNuaXBwZXQnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVGhpcyBpcyBhIHRlc3Qgc25pcHBldCcsXG4gICAgICAgICAgY29kZTogJ2NvbnNvbGUubG9nKFwiSGVsbG8gV29ybGRcIik7JyxcbiAgICAgICAgICBsYW5ndWFnZTogJ2phdmFzY3JpcHQnLFxuICAgICAgICAgIGlzUHVibGljOiB0cnVlLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdFxuICAgICAgICBjb25zdCByZXN1bHQgPSBDcmVhdGVTbmlwcGV0U2NoZW1hLnBhcnNlKGlucHV0KTtcblxuICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgZXhwZWN0KHJlc3VsdC50aXRsZSkudG9CZSgnVGVzdCBTbmlwcGV0Jyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZGVzY3JpcHRpb24pLnRvQmUoJ1RoaXMgaXMgYSB0ZXN0IHNuaXBwZXQnKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jb2RlKS50b0JlKCdjb25zb2xlLmxvZyhcIkhlbGxvIFdvcmxkXCIpOycpO1xuICAgICAgICBleHBlY3QocmVzdWx0Lmxhbmd1YWdlKS50b0JlKCdqYXZhc2NyaXB0Jyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuaXNQdWJsaWMpLnRvQmUodHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBzbmlwcGV0IHdpdGhvdXQgb3B0aW9uYWwgZmllbGRzJywgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICAgIHRpdGxlOiAnTWluaW1hbCBTbmlwcGV0JyxcbiAgICAgICAgICBjb2RlOiAncHJpbnQoXCJIZWxsb1wiKScsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdweXRob24nLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdFxuICAgICAgICBjb25zdCByZXN1bHQgPSBDcmVhdGVTbmlwcGV0U2NoZW1hLnBhcnNlKGlucHV0KTtcblxuICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgZXhwZWN0KHJlc3VsdC50aXRsZSkudG9CZSgnTWluaW1hbCBTbmlwcGV0Jyk7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuY29kZSkudG9CZSgncHJpbnQoXCJIZWxsb1wiKScpO1xuICAgICAgICBleHBlY3QocmVzdWx0Lmxhbmd1YWdlKS50b0JlKCdweXRob24nKTtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kZXNjcmlwdGlvbikudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzdWx0LmlzUHVibGljKS50b0JlKHRydWUpOyAvLyBkZWZhdWx0IHZhbHVlXG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0cmltIHdoaXRlc3BhY2UgZnJvbSB0aXRsZScsICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgICB0aXRsZTogJyAgVHJpbW1lZCBUaXRsZSAgJyxcbiAgICAgICAgICBjb2RlOiAnY29kZScsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICd0eXBlc2NyaXB0JyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3RcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gQ3JlYXRlU25pcHBldFNjaGVtYS5wYXJzZShpbnB1dCk7XG5cbiAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgIGV4cGVjdChyZXN1bHQudGl0bGUpLnRvQmUoJ1RyaW1tZWQgVGl0bGUnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRyaW0gd2hpdGVzcGFjZSBmcm9tIGRlc2NyaXB0aW9uJywgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICAgIHRpdGxlOiAnVGVzdCcsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICcgIFRyaW1tZWQgRGVzY3JpcHRpb24gICcsXG4gICAgICAgICAgY29kZTogJ2NvZGUnLFxuICAgICAgICAgIGxhbmd1YWdlOiAndHlwZXNjcmlwdCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IENyZWF0ZVNuaXBwZXRTY2hlbWEucGFyc2UoaW5wdXQpO1xuXG4gICAgICAgIC8vIEFzc2VydFxuICAgICAgICBleHBlY3QocmVzdWx0LmRlc2NyaXB0aW9uKS50b0JlKCdUcmltbWVkIERlc2NyaXB0aW9uJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjb252ZXJ0IGxhbmd1YWdlIHRvIGxvd2VyY2FzZScsICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgICB0aXRsZTogJ1Rlc3QnLFxuICAgICAgICAgIGNvZGU6ICdjb2RlJyxcbiAgICAgICAgICBsYW5ndWFnZTogJ1R5cGVTY3JpcHQnLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdFxuICAgICAgICBjb25zdCByZXN1bHQgPSBDcmVhdGVTbmlwcGV0U2NoZW1hLnBhcnNlKGlucHV0KTtcblxuICAgICAgICAvLyBBc3NlcnRcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5sYW5ndWFnZSkudG9CZSgndHlwZXNjcmlwdCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgYWNjZXB0IGh5cGhlbmF0ZWQgbGFuZ3VhZ2UgbmFtZXMnLCAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgaW5wdXQgPSB7XG4gICAgICAgICAgdGl0bGU6ICdUZXN0JyxcbiAgICAgICAgICBjb2RlOiAnY29kZScsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdjLXNoYXJwJyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3RcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gQ3JlYXRlU25pcHBldFNjaGVtYS5wYXJzZShpbnB1dCk7XG5cbiAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgIGV4cGVjdChyZXN1bHQubGFuZ3VhZ2UpLnRvQmUoJ2Mtc2hhcnAnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGFjY2VwdCBudW1lcmljIGxhbmd1YWdlIG5hbWVzJywgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICAgIHRpdGxlOiAnVGVzdCcsXG4gICAgICAgICAgY29kZTogJ2NvZGUnLFxuICAgICAgICAgIGxhbmd1YWdlOiAnYzk5JyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3RcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gQ3JlYXRlU25pcHBldFNjaGVtYS5wYXJzZShpbnB1dCk7XG5cbiAgICAgICAgLy8gQXNzZXJ0XG4gICAgICAgIGV4cGVjdChyZXN1bHQubGFuZ3VhZ2UpLnRvQmUoJ2M5OScpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnd2l0aCBpbnZhbGlkIGRhdGEnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJlamVjdCBlbXB0eSB0aXRsZScsICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgICB0aXRsZTogJycsXG4gICAgICAgICAgY29kZTogJ2NvZGUnLFxuICAgICAgICAgIGxhbmd1YWdlOiAnamF2YXNjcmlwdCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICAgIGV4cGVjdCgoKSA9PiBDcmVhdGVTbmlwcGV0U2NoZW1hLnBhcnNlKGlucHV0KSkudG9UaHJvdygpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVqZWN0IHRpdGxlIGV4Y2VlZGluZyAyMDAgY2hhcmFjdGVycycsICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgICB0aXRsZTogJ2EnLnJlcGVhdCgyMDEpLFxuICAgICAgICAgIGNvZGU6ICdjb2RlJyxcbiAgICAgICAgICBsYW5ndWFnZTogJ2phdmFzY3JpcHQnLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgICBleHBlY3QoKCkgPT4gQ3JlYXRlU25pcHBldFNjaGVtYS5wYXJzZShpbnB1dCkpLnRvVGhyb3coKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHJlamVjdCBkZXNjcmlwdGlvbiBleGNlZWRpbmcgMTAwMCBjaGFyYWN0ZXJzJywgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICAgIHRpdGxlOiAnVGVzdCcsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdhJy5yZXBlYXQoMTAwMSksXG4gICAgICAgICAgY29kZTogJ2NvZGUnLFxuICAgICAgICAgIGxhbmd1YWdlOiAnamF2YXNjcmlwdCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICAgIGV4cGVjdCgoKSA9PiBDcmVhdGVTbmlwcGV0U2NoZW1hLnBhcnNlKGlucHV0KSkudG9UaHJvdygpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVqZWN0IGVtcHR5IGNvZGUnLCAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgaW5wdXQgPSB7XG4gICAgICAgICAgdGl0bGU6ICdUZXN0JyxcbiAgICAgICAgICBjb2RlOiAnJyxcbiAgICAgICAgICBsYW5ndWFnZTogJ2phdmFzY3JpcHQnLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgICBleHBlY3QoKCkgPT4gQ3JlYXRlU25pcHBldFNjaGVtYS5wYXJzZShpbnB1dCkpLnRvVGhyb3coKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHJlamVjdCBjb2RlIGV4Y2VlZGluZyA1MDAwMCBjaGFyYWN0ZXJzJywgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICAgIHRpdGxlOiAnVGVzdCcsXG4gICAgICAgICAgY29kZTogJ2EnLnJlcGVhdCg1MDAwMSksXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdqYXZhc2NyaXB0JyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgICAgZXhwZWN0KCgpID0+IENyZWF0ZVNuaXBwZXRTY2hlbWEucGFyc2UoaW5wdXQpKS50b1Rocm93KCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZWplY3QgZW1wdHkgbGFuZ3VhZ2UnLCAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgaW5wdXQgPSB7XG4gICAgICAgICAgdGl0bGU6ICdUZXN0JyxcbiAgICAgICAgICBjb2RlOiAnY29kZScsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICcnLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgICBleHBlY3QoKCkgPT4gQ3JlYXRlU25pcHBldFNjaGVtYS5wYXJzZShpbnB1dCkpLnRvVGhyb3coKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHJlamVjdCBsYW5ndWFnZSB3aXRoIHNwYWNlcycsICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgICB0aXRsZTogJ1Rlc3QnLFxuICAgICAgICAgIGNvZGU6ICdjb2RlJyxcbiAgICAgICAgICBsYW5ndWFnZTogJ2phdmEgc2NyaXB0JyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgICAgZXhwZWN0KCgpID0+IENyZWF0ZVNuaXBwZXRTY2hlbWEucGFyc2UoaW5wdXQpKS50b1Rocm93KCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZWplY3QgbGFuZ3VhZ2Ugd2l0aCB1cHBlcmNhc2UgYW5kIHNwZWNpYWwgY2hhcnMnLCAoKSA9PiB7XG4gICAgICAgIC8vIEFycmFuZ2VcbiAgICAgICAgY29uc3QgaW5wdXQgPSB7XG4gICAgICAgICAgdGl0bGU6ICdUZXN0JyxcbiAgICAgICAgICBjb2RlOiAnY29kZScsXG4gICAgICAgICAgbGFuZ3VhZ2U6ICdKYXZhU2NyaXB0IScsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICAgIGV4cGVjdCgoKSA9PiBDcmVhdGVTbmlwcGV0U2NoZW1hLnBhcnNlKGlucHV0KSkudG9UaHJvdygpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVqZWN0IG1pc3NpbmcgcmVxdWlyZWQgZmllbGRzJywgKCkgPT4ge1xuICAgICAgICAvLyBBcnJhbmdlXG4gICAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICAgIHRpdGxlOiAnVGVzdCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQWN0ICYgQXNzZXJ0XG4gICAgICAgIGV4cGVjdCgoKSA9PiBDcmVhdGVTbmlwcGV0U2NoZW1hLnBhcnNlKGlucHV0KSkudG9UaHJvdygpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmVqZWN0IGludmFsaWQgaXNQdWJsaWMgdHlwZScsICgpID0+IHtcbiAgICAgICAgLy8gQXJyYW5nZVxuICAgICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgICB0aXRsZTogJ1Rlc3QnLFxuICAgICAgICAgIGNvZGU6ICdjb2RlJyxcbiAgICAgICAgICBsYW5ndWFnZTogJ2phdmFzY3JpcHQnLFxuICAgICAgICAgIGlzUHVibGljOiAneWVzJyxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBY3QgJiBBc3NlcnRcbiAgICAgICAgZXhwZWN0KCgpID0+IENyZWF0ZVNuaXBwZXRTY2hlbWEucGFyc2UoaW5wdXQpKS50b1Rocm93KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3ZhbGlkYXRlQ3JlYXRlU25pcHBldER0bycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHBhcnNlIHZhbGlkIGRhdGEnLCAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgdGl0bGU6ICdUZXN0JyxcbiAgICAgICAgY29kZTogJ2NvbnNvbGUubG9nKFwidGVzdFwiKTsnLFxuICAgICAgICBsYW5ndWFnZTogJ2phdmFzY3JpcHQnLFxuICAgICAgfTtcblxuICAgICAgLy8gQWN0XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZUNyZWF0ZVNuaXBwZXREdG8oaW5wdXQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnRpdGxlKS50b0JlKCdUZXN0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IG9uIGludmFsaWQgZGF0YScsICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICB0aXRsZTogJycsXG4gICAgICAgIGNvZGU6ICdjb2RlJyxcbiAgICAgICAgbGFuZ3VhZ2U6ICdqYXZhc2NyaXB0JyxcbiAgICAgIH07XG5cbiAgICAgIC8vIEFjdCAmIEFzc2VydFxuICAgICAgZXhwZWN0KCgpID0+IHZhbGlkYXRlQ3JlYXRlU25pcHBldER0byhpbnB1dCkpLnRvVGhyb3coKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NhZmVWYWxpZGF0ZUNyZWF0ZVNuaXBwZXREdG8nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gc3VjY2VzcyBmb3IgdmFsaWQgZGF0YScsICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICB0aXRsZTogJ1Rlc3QnLFxuICAgICAgICBjb2RlOiAnY29kZScsXG4gICAgICAgIGxhbmd1YWdlOiAnamF2YXNjcmlwdCcsXG4gICAgICB9O1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhZmVWYWxpZGF0ZUNyZWF0ZVNuaXBwZXREdG8oaW5wdXQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgICBleHBlY3QocmVzdWx0LmRhdGEudGl0bGUpLnRvQmUoJ1Rlc3QnKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGVycm9yIGZvciBpbnZhbGlkIGRhdGEnLCAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBpbnB1dCA9IHtcbiAgICAgICAgdGl0bGU6ICcnLFxuICAgICAgICBjb2RlOiAnY29kZScsXG4gICAgICAgIGxhbmd1YWdlOiAnamF2YXNjcmlwdCcsXG4gICAgICB9O1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhZmVWYWxpZGF0ZUNyZWF0ZVNuaXBwZXREdG8oaW5wdXQpO1xuXG4gICAgICAvLyBBc3NlcnRcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7XG4gICAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVEZWZpbmVkKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd0eXBlIGluZmVyZW5jZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGluZmVyIGNvcnJlY3QgVHlwZVNjcmlwdCB0eXBlJywgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3Qgc25pcHBldDogQ3JlYXRlU25pcHBldER0byA9IHtcbiAgICAgICAgdGl0bGU6ICdUZXN0JyxcbiAgICAgICAgY29kZTogJ2NvZGUnLFxuICAgICAgICBsYW5ndWFnZTogJ2phdmFzY3JpcHQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ29wdGlvbmFsJyxcbiAgICAgICAgaXNQdWJsaWM6IGZhbHNlLFxuICAgICAgfTtcblxuICAgICAgLy8gQXNzZXJ0IC0gVHlwZVNjcmlwdCBzaG91bGQgbm90IGNvbXBsYWluXG4gICAgICBleHBlY3Qoc25pcHBldC50aXRsZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChzbmlwcGV0LmNvZGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3Qoc25pcHBldC5sYW5ndWFnZSkudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==